
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A unified framework for representative subset selection in multi-variate time-series spaces">
      
      
      
        <link rel="canonical" href="https://energy-repset-docs.mesqual.io/api/representation/">
      
      
        <link rel="prev" href="../search_algorithms/">
      
      
        <link rel="next" href="../diagnostics/">
      
      
        
      
      
      <link rel="icon" href="../../assets/logo-red.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Representation - energy-repset</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#representation-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="energy-repset" class="md-header__button md-logo" aria-label="energy-repset" data-md-component="logo">
      
  <img src="../../assets/logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            energy-repset
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Representation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/helgeesch/energy-repset" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    helgeesch/energy-repset
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://energy-repset.mesqual.io" class="md-tabs__link">
        
  
  
    
  
  Website ↗

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="energy-repset" class="md-nav__button md-logo" aria-label="energy-repset" data-md-component="logo">
      
  <img src="../../assets/logo-white.svg" alt="logo">

    </a>
    energy-repset
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/helgeesch/energy-repset" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    helgeesch/energy-repset
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    energy-repset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unified_framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unified Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules & Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../constructive_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advisor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration Advisor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex1_getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 1: Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex2_feature_space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 2: Feature Space Exploration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex3_hierarchical_selection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 3: Hierarchical Seasonal Selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex4_representation_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 4: Comparing Representation Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex5_multi_objective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 5: Multi-Objective Exploration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex6_constructive_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 6: Constructive Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context & Slicing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow & Experiment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature_engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature Engineering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objectives
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../score_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Score Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combi_gens/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Combination Generators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../selection_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Selection Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Representation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Representation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        RepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        UniformRepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UniformRepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        KMedoidsClustersizeRepresentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KMedoidsClustersizeRepresentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        BlendedRepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BlendedRepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diagnostics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagnostics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://energy-repset.mesqual.io" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Website ↗
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        RepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.RepresentationModel.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        UniformRepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UniformRepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.UniformRepresentationModel.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        KMedoidsClustersizeRepresentation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KMedoidsClustersizeRepresentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.weigh" class="md-nav__link">
    <span class="md-ellipsis">
      
        weigh
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        BlendedRepresentationModel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BlendedRepresentationModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.representation.BlendedRepresentationModel.fit" class="md-nav__link">
    <span class="md-ellipsis">
      
        fit
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="representation-models">Representation Models<a class="headerlink" href="#representation-models" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-class">



<h2 id="energy_repset.representation.RepresentationModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">RepresentationModel</span>


<a href="#energy_repset.representation.RepresentationModel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>



        <p>Base class for representation models (Pillar R).</p>
<p>Defines how selected representative periods represent the full dataset by
calculating responsibility weights. The model is first fitted to learn about
the entire dataset, then the weigh() method calculates weights for specific
selections.</p>
<p>Different models implement different weighting strategies:
- Uniform: Equal weights (e.g., 365/k for yearly data)
- Cluster-based: Weights proportional to cluster sizes
- Blended: Soft assignment where each period is a weighted mix of representatives</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">UniformWeights</span><span class="p">(</span><span class="n">RepresentationModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">n_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">slicer</span><span class="o">.</span><span class="n">slices</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_total</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">{</span><span class="n">slice_id</span><span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">slice_id</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">}</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">UniformWeights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">weigh</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>  <span class="c1"># {0: 91.25, 3: 91.25, 6: 91.25, 9: 91.25} for 365 days, k=4</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span><span class="w"> </span><span class="nc">ClusterSizeWeights</span><span class="p">(</span><span class="n">RepresentationModel</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="gp">... </span>        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">KMeans</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">df_features</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
<span class="gp">... </span>        <span class="n">weights</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slice_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combination</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">cluster_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">... </span>            <span class="n">weights</span><span class="p">[</span><span class="n">slice_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">cluster_size</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">weights</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">ClusterSizeWeights</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">weigh</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>  <span class="c1"># Weights proportional to cluster membership</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/representation/representation.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RepresentationModel</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for representation models (Pillar R).</span>

<span class="sd">    Defines how selected representative periods represent the full dataset by</span>
<span class="sd">    calculating responsibility weights. The model is first fitted to learn about</span>
<span class="sd">    the entire dataset, then the weigh() method calculates weights for specific</span>
<span class="sd">    selections.</span>

<span class="sd">    Different models implement different weighting strategies:</span>
<span class="sd">    - Uniform: Equal weights (e.g., 365/k for yearly data)</span>
<span class="sd">    - Cluster-based: Weights proportional to cluster sizes</span>
<span class="sd">    - Blended: Soft assignment where each period is a weighted mix of representatives</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; class UniformWeights(RepresentationModel):</span>
<span class="sd">        ...     def fit(self, context: ProblemContext):</span>
<span class="sd">        ...         self.n_total = len(context.slicer.slices)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     def weigh(self, combination: SliceCombination) -&gt; Dict[Hashable, float]:</span>
<span class="sd">        ...         weight = self.n_total / len(combination)</span>
<span class="sd">        ...         return {slice_id: weight for slice_id in combination}</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; model = UniformWeights()</span>
<span class="sd">        &gt;&gt;&gt; model.fit(context)</span>
<span class="sd">        &gt;&gt;&gt; weights = model.weigh((0, 3, 6, 9))</span>
<span class="sd">        &gt;&gt;&gt; print(weights)  # {0: 91.25, 3: 91.25, 6: 91.25, 9: 91.25} for 365 days, k=4</span>

<span class="sd">        &gt;&gt;&gt; class ClusterSizeWeights(RepresentationModel):</span>
<span class="sd">        ...     def fit(self, context: ProblemContext):</span>
<span class="sd">        ...         from sklearn.cluster import KMeans</span>
<span class="sd">        ...         self.kmeans = KMeans(n_clusters=4)</span>
<span class="sd">        ...         self.kmeans.fit(context.df_features)</span>
<span class="sd">        ...</span>
<span class="sd">        ...     def weigh(self, combination: SliceCombination) -&gt; Dict[Hashable, float]:</span>
<span class="sd">        ...         labels = self.kmeans.labels_</span>
<span class="sd">        ...         weights = {}</span>
<span class="sd">        ...         for i, slice_id in enumerate(combination):</span>
<span class="sd">        ...             cluster_size = (labels == i).sum()</span>
<span class="sd">        ...             weights[slice_id] = cluster_size</span>
<span class="sd">        ...         return weights</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; model = ClusterSizeWeights()</span>
<span class="sd">        &gt;&gt;&gt; model.fit(context)</span>
<span class="sd">        &gt;&gt;&gt; weights = model.weigh((0, 3, 6, 9))</span>
<span class="sd">        &gt;&gt;&gt; print(weights)  # Weights proportional to cluster membership</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the representation model to the full dataset.</span>

<span class="sd">        This method performs any necessary pre-computation based on the full set</span>
<span class="sd">        of candidate slices (e.g., storing the feature matrix, fitting clustering</span>
<span class="sd">        models, computing distance matrices).</span>

<span class="sd">        Args:</span>
<span class="sd">            context: The problem context with df_features populated. Feature</span>
<span class="sd">                engineering must be run before calling this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate representation weights for a given selection.</span>

<span class="sd">        This method should only be called after the model has been fitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            combination: Tuple of selected slice identifiers for which to</span>
<span class="sd">                calculate representation weights.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The calculated weights, either as a dictionary mapping each selected</span>
<span class="sd">            slice to its weight, or as a DataFrame for more complex weight</span>
<span class="sd">            structures (e.g., blended models where each original period has</span>
<span class="sd">            weights across multiple representatives).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.RepresentationModel.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fit</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#energy_repset.representation.RepresentationModel.fit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fit</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fit the representation model to the full dataset.</p>
<p>This method performs any necessary pre-computation based on the full set
of candidate slices (e.g., storing the feature matrix, fitting clustering
models, computing distance matrices).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code>&#39;ProblemContext&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The problem context with df_features populated. Feature
engineering must be run before calling this method.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/representation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit the representation model to the full dataset.</span>

<span class="sd">    This method performs any necessary pre-computation based on the full set</span>
<span class="sd">    of candidate slices (e.g., storing the feature matrix, fitting clustering</span>
<span class="sd">    models, computing distance matrices).</span>

<span class="sd">    Args:</span>
<span class="sd">        context: The problem context with df_features populated. Feature</span>
<span class="sd">            engineering must be run before calling this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.RepresentationModel.weigh" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weigh</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#energy_repset.representation.RepresentationModel.weigh" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">weigh</span><span class="p">(</span><span class="n">combination</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="typing.Hashable">Hashable</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate representation weights for a given selection.</p>
<p>This method should only be called after the model has been fitted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combination</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of selected slice identifiers for which to
calculate representation weights.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>] | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The calculated weights, either as a dictionary mapping each selected</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>] | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>slice to its weight, or as a DataFrame for more complex weight</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>] | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>structures (e.g., blended models where each original period has</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>] | <span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>weights across multiple representatives).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/representation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate representation weights for a given selection.</span>

<span class="sd">    This method should only be called after the model has been fitted.</span>

<span class="sd">    Args:</span>
<span class="sd">        combination: Tuple of selected slice identifiers for which to</span>
<span class="sd">            calculate representation weights.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The calculated weights, either as a dictionary mapping each selected</span>
<span class="sd">        slice to its weight, or as a DataFrame for more complex weight</span>
<span class="sd">        structures (e.g., blended models where each original period has</span>
<span class="sd">        weights across multiple representatives).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="energy_repset.representation.UniformRepresentationModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">UniformRepresentationModel</span>


<a href="#energy_repset.representation.UniformRepresentationModel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            RepresentationModel (energy_repset.representation.representation.RepresentationModel)" href="#energy_repset.representation.RepresentationModel">RepresentationModel</a></code></p>



        <p>Assigns equal weights to all selected representatives.</p>
<p>The simplest representation model where each selected period gets weight
1/k. This is appropriate when you want each representative to contribute
equally to downstream modeling, regardless of how many original periods
it represents.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; model = UniformRepresentationModel()
&gt;&gt;&gt; model.fit(context)
&gt;&gt;&gt; weights = model.weigh((0, 3, 6, 9))
&gt;&gt;&gt; print(weights)
    {0: 0.25, 3: 0.25, 6: 0.25, 9: 0.25}

&gt;&gt;&gt; # For yearly data with k=4 months, each month represents ~91 days
&gt;&gt;&gt; # Weights sum to 1.0 for normalized analysis
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/representation/uniform.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UniformRepresentationModel</span><span class="p">(</span><span class="n">RepresentationModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns equal weights to all selected representatives.</span>

<span class="sd">    The simplest representation model where each selected period gets weight</span>
<span class="sd">    1/k. This is appropriate when you want each representative to contribute</span>
<span class="sd">    equally to downstream modeling, regardless of how many original periods</span>
<span class="sd">    it represents.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; model = UniformRepresentationModel()</span>
<span class="sd">        &gt;&gt;&gt; model.fit(context)</span>
<span class="sd">        &gt;&gt;&gt; weights = model.weigh((0, 3, 6, 9))</span>
<span class="sd">        &gt;&gt;&gt; print(weights)</span>
<span class="sd">            {0: 0.25, 3: 0.25, 6: 0.25, 9: 0.25}</span>

<span class="sd">        &gt;&gt;&gt; # For yearly data with k=4 months, each month represents ~91 days</span>
<span class="sd">        &gt;&gt;&gt; # Weights sum to 1.0 for normalized analysis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;No fitting required for uniform weighting.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Problem context (unused but required by protocol).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate uniform weights (1/k for each selected period).</span>

<span class="sd">        Args:</span>
<span class="sd">            combination: Tuple of selected slice identifiers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary mapping each slice ID to its weight (1/k).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">combination</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.UniformRepresentationModel.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fit</span>


<a href="#energy_repset.representation.UniformRepresentationModel.fit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fit</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProblemContext (energy_repset.context.ProblemContext)" href="../context/#energy_repset.context.ProblemContext">ProblemContext</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>No fitting required for uniform weighting.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ProblemContext (energy_repset.context.ProblemContext)" href="../context/#energy_repset.context.ProblemContext">ProblemContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Problem context (unused but required by protocol).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/uniform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No fitting required for uniform weighting.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Problem context (unused but required by protocol).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.UniformRepresentationModel.weigh" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weigh</span>


<a href="#energy_repset.representation.UniformRepresentationModel.weigh" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">weigh</span><span class="p">(</span><span class="n">combination</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="typing.Hashable">Hashable</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate uniform weights (1/k for each selected period).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combination</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of selected slice identifiers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping each slice ID to its weight (1/k).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/uniform.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate uniform weights (1/k for each selected period).</span>

<span class="sd">    Args:</span>
<span class="sd">        combination: Tuple of selected slice identifiers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary mapping each slice ID to its weight (1/k).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">combination</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="energy_repset.representation.KMedoidsClustersizeRepresentation" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">KMedoidsClustersizeRepresentation</span>


<a href="#energy_repset.representation.KMedoidsClustersizeRepresentation" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            RepresentationModel (energy_repset.representation.representation.RepresentationModel)" href="#energy_repset.representation.RepresentationModel">RepresentationModel</a></code></p>



        <p>Assigns weights based on k-medoids cluster sizes (hard assignment).</p>
<p>This representation model performs virtual k-medoids clustering where the
selected periods are enforced as medoids (cluster centers). Each candidate
period is assigned to its nearest medoid, and weights are calculated as
the proportion of periods assigned to each medoid.</p>
<p>The weights reflect how many original periods each representative is
responsible for, making this appropriate when representatives should be
weighted by their "sphere of influence" in feature space.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="energy_repset.representation.KMedoidsClustersizeRepresentation.all_features_">all_features_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix for all candidate periods (set during fit).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="energy_repset.representation.KMedoidsClustersizeRepresentation.all_slice_labels_">all_slice_labels_</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for all candidate periods (set during fit).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; model = KMedoidsClustersizeRepresentation()
&gt;&gt;&gt; model.fit(context)  # context has 12 monthly candidates
&gt;&gt;&gt; weights = model.weigh((Period(&#39;2024-01&#39;, &#39;M&#39;), Period(&#39;2024-06&#39;, &#39;M&#39;)))
&gt;&gt;&gt; print(weights)
    {Period(&#39;2024-01&#39;, &#39;M&#39;): 0.583, Period(&#39;2024-06&#39;, &#39;M&#39;): 0.417}
&gt;&gt;&gt; # Jan represents 7 months, Jun represents 5 months
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/representation/k_medoids_clustersize.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">KMedoidsClustersizeRepresentation</span><span class="p">(</span><span class="n">RepresentationModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns weights based on k-medoids cluster sizes (hard assignment).</span>

<span class="sd">    This representation model performs virtual k-medoids clustering where the</span>
<span class="sd">    selected periods are enforced as medoids (cluster centers). Each candidate</span>
<span class="sd">    period is assigned to its nearest medoid, and weights are calculated as</span>
<span class="sd">    the proportion of periods assigned to each medoid.</span>

<span class="sd">    The weights reflect how many original periods each representative is</span>
<span class="sd">    responsible for, making this appropriate when representatives should be</span>
<span class="sd">    weighted by their &quot;sphere of influence&quot; in feature space.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        all_features_: Feature matrix for all candidate periods (set during fit).</span>
<span class="sd">        all_slice_labels_: Labels for all candidate periods (set during fit).</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; model = KMedoidsClustersizeRepresentation()</span>
<span class="sd">        &gt;&gt;&gt; model.fit(context)  # context has 12 monthly candidates</span>
<span class="sd">        &gt;&gt;&gt; weights = model.weigh((Period(&#39;2024-01&#39;, &#39;M&#39;), Period(&#39;2024-06&#39;, &#39;M&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; print(weights)</span>
<span class="sd">            {Period(&#39;2024-01&#39;, &#39;M&#39;): 0.583, Period(&#39;2024-06&#39;, &#39;M&#39;): 0.417}</span>
<span class="sd">        &gt;&gt;&gt; # Jan represents 7 months, Jun represents 5 months</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Store the full feature matrix for later clustering.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: Problem context containing df_features and candidates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">df_features</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">slicer</span><span class="o">.</span><span class="n">unique_slices</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">df_raw</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate weights based on cluster sizes from hard assignment.</span>

<span class="sd">        Performs virtual k-medoids clustering where:</span>
<span class="sd">        1. Selected periods are enforced as medoids</span>
<span class="sd">        2. Each candidate is assigned to its nearest medoid (Euclidean distance)</span>
<span class="sd">        3. Weight = (cluster size) / (total candidates)</span>

<span class="sd">        Args:</span>
<span class="sd">            combination: Tuple of selected slice identifiers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary mapping each slice ID to its weight (proportion of</span>
<span class="sd">            candidates assigned to it).</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If combination contains slices not in the feature matrix.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">combination</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="c1"># Extract feature vectors for selected medoids</span>
        <span class="n">medoid_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">slice_label</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">slice_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slice </span><span class="si">{</span><span class="n">slice_label</span><span class="si">}</span><span class="s2"> not found in candidates&quot;</span><span class="p">)</span>
            <span class="n">medoid_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">slice_label</span><span class="p">))</span>

        <span class="n">medoid_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">medoid_indices</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">all_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Compute pairwise distances: shape (n_candidates, k_medoids)</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">all_features</span><span class="p">,</span> <span class="n">medoid_features</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

        <span class="c1"># Hard assignment: each candidate assigned to nearest medoid</span>
        <span class="n">assignments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Count cluster sizes</span>
        <span class="n">cluster_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">))</span>

        <span class="c1"># Calculate weights as proportions</span>
        <span class="n">total_candidates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="p">)</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">slice_label</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">cluster_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">total_candidates</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slice_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">weights</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.KMedoidsClustersizeRepresentation.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fit</span>


<a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.fit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fit</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ProblemContext (energy_repset.context.ProblemContext)" href="../context/#energy_repset.context.ProblemContext">ProblemContext</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Store the full feature matrix for later clustering.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ProblemContext (energy_repset.context.ProblemContext)" href="../context/#energy_repset.context.ProblemContext">ProblemContext</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Problem context containing df_features and candidates.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/k_medoids_clustersize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">ProblemContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Store the full feature matrix for later clustering.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: Problem context containing df_features and candidates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">df_features</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">slicer</span><span class="o">.</span><span class="n">unique_slices</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">df_raw</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.KMedoidsClustersizeRepresentation.weigh" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">weigh</span>


<a href="#energy_repset.representation.KMedoidsClustersizeRepresentation.weigh" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">weigh</span><span class="p">(</span><span class="n">combination</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="typing.Hashable">Hashable</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate weights based on cluster sizes from hard assignment.</p>
<p>Performs virtual k-medoids clustering where:
1. Selected periods are enforced as medoids
2. Each candidate is assigned to its nearest medoid (Euclidean distance)
3. Weight = (cluster size) / (total candidates)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combination</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of selected slice identifiers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping each slice ID to its weight (proportion of</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>candidates assigned to it).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If combination contains slices not in the feature matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/k_medoids_clustersize.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate weights based on cluster sizes from hard assignment.</span>

<span class="sd">    Performs virtual k-medoids clustering where:</span>
<span class="sd">    1. Selected periods are enforced as medoids</span>
<span class="sd">    2. Each candidate is assigned to its nearest medoid (Euclidean distance)</span>
<span class="sd">    3. Weight = (cluster size) / (total candidates)</span>

<span class="sd">    Args:</span>
<span class="sd">        combination: Tuple of selected slice identifiers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary mapping each slice ID to its weight (proportion of</span>
<span class="sd">        candidates assigned to it).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If combination contains slices not in the feature matrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">combination</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="c1"># Extract feature vectors for selected medoids</span>
    <span class="n">medoid_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">slice_label</span> <span class="ow">in</span> <span class="n">combination</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">slice_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Slice </span><span class="si">{</span><span class="n">slice_label</span><span class="si">}</span><span class="s2"> not found in candidates&quot;</span><span class="p">)</span>
        <span class="n">medoid_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">slice_label</span><span class="p">))</span>

    <span class="n">medoid_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">medoid_indices</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">all_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Compute pairwise distances: shape (n_candidates, k_medoids)</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">all_features</span><span class="p">,</span> <span class="n">medoid_features</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>

    <span class="c1"># Hard assignment: each candidate assigned to nearest medoid</span>
    <span class="n">assignments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Count cluster sizes</span>
    <span class="n">cluster_sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">))</span>

    <span class="c1"># Calculate weights as proportions</span>
    <span class="n">total_candidates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_slice_labels_</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">slice_label</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">cluster_sizes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">total_candidates</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">slice_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">weights</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="energy_repset.representation.BlendedRepresentationModel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">BlendedRepresentationModel</span>


<a href="#energy_repset.representation.BlendedRepresentationModel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            RepresentationModel (energy_repset.representation.representation.RepresentationModel)" href="#energy_repset.representation.RepresentationModel">RepresentationModel</a></code></p>



        <p>Assigns weights using a blended representation (R_soft).</p>
<p>Each original slice in the full dataset is represented as a unique
weighted combination of all the selected representatives. This is found by
solving a small optimization problem for each original slice.</p>
<p>The output is a DataFrame where rows are the original slice labels,
columns are the selected representative labels, and values are the weights.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/representation/blended.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BlendedRepresentationModel</span><span class="p">(</span><span class="n">RepresentationModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assigns weights using a blended representation (R_soft).</span>

<span class="sd">    Each original slice in the full dataset is represented as a unique</span>
<span class="sd">    weighted combination of all the selected representatives. This is found by</span>
<span class="sd">    solving a small optimization problem for each original slice.</span>

<span class="sd">    The output is a DataFrame where rows are the original slice labels,</span>
<span class="sd">    columns are the selected representative labels, and values are the weights.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blend_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;convex&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        blend_type : str, optional</span>
<span class="sd">            The type of blend to perform. &#39;convex&#39; is the most common,</span>
<span class="sd">            ensuring weights are non-negative and sum to 1.</span>
<span class="sd">            (default is &#39;convex&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">blend_type</span> <span class="o">!=</span> <span class="s1">&#39;convex&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only &#39;convex&#39; blend type is currently supported.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blend_type</span> <span class="o">=</span> <span class="n">blend_type</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stores the full feature matrix for later use.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">df_features</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">weigh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">combination</span><span class="p">:</span> <span class="n">SliceCombination</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">combination</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">all_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span>
        <span class="n">rep_features</span> <span class="o">=</span> <span class="n">all_features</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">combination</span><span class="p">)]</span>

        <span class="n">weight_results</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 2. Loop through every original slice in the full dataset.</span>
        <span class="k">for</span> <span class="n">original_label</span><span class="p">,</span> <span class="n">original_vec</span> <span class="ow">in</span> <span class="n">all_features</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="c1"># 3. For each one, solve an optimization problem to find the best blend.</span>
            <span class="c1"># Objective: minimize || original_vec - sum(weights * rep_vecs) ||^2</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">objective_func</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
                <span class="n">blended_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">rep_features</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">original_vec</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">blended_vec</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Initial guess: uniform weights</span>
            <span class="n">initial_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>

            <span class="c1"># Constraints and bounds for a convex blend</span>
            <span class="n">constraints</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;eq&#39;</span><span class="p">,</span> <span class="s1">&#39;fun&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">})</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combination</span><span class="p">))]</span>

            <span class="c1"># 4. Solve for the optimal weights for this specific original_slice.</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
                <span class="n">objective_func</span><span class="p">,</span>
                <span class="n">initial_weights</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SLSQP&#39;</span><span class="p">,</span>
                <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
                <span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span>
            <span class="p">)</span>

            <span class="n">weight_results</span><span class="p">[</span><span class="n">original_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span>

        <span class="c1"># 5. Assemble the results into a final DataFrame and return.</span>
        <span class="n">blended_weights_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
            <span class="n">weight_results</span><span class="p">,</span>
            <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">combination</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">blended_weights_df</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.BlendedRepresentationModel.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.representation.BlendedRepresentationModel.__init__" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">blend_type</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;convex&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <h5 id="energy_repset.representation.BlendedRepresentationModel.__init__--parameters">Parameters<a class="headerlink" href="#energy_repset.representation.BlendedRepresentationModel.__init__--parameters" title="Permanent link">&para;</a></h5>
<p>blend_type : str, optional
    The type of blend to perform. 'convex' is the most common,
    ensuring weights are non-negative and sum to 1.
    (default is 'convex')</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/blended.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blend_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;convex&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    blend_type : str, optional</span>
<span class="sd">        The type of blend to perform. &#39;convex&#39; is the most common,</span>
<span class="sd">        ensuring weights are non-negative and sum to 1.</span>
<span class="sd">        (default is &#39;convex&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">blend_type</span> <span class="o">!=</span> <span class="s1">&#39;convex&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Only &#39;convex&#39; blend type is currently supported.&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">blend_type</span> <span class="o">=</span> <span class="n">blend_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="energy_repset.representation.BlendedRepresentationModel.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">fit</span>


<a href="#energy_repset.representation.BlendedRepresentationModel.fit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">fit</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Stores the full feature matrix for later use.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/representation/blended.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s1">&#39;ProblemContext&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stores the full feature matrix for later use.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">all_features_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">df_features</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "content.tabs.link", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../javascripts/github_source_links.js"></script>
      
    
  </body>
</html>