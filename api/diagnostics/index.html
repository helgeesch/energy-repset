
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A unified framework for representative subset selection in multi-variate time-series spaces">
      
      
      
        <link rel="canonical" href="https://energy-repset-docs.mesqual.io/api/diagnostics/">
      
      
        <link rel="prev" href="../representation/">
      
      
      
        
      
      
      <link rel="icon" href="../../assets/logo-red.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Diagnostics - energy-repset</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#diagnostics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="energy-repset" class="md-header__button md-logo" aria-label="energy-repset" data-md-component="logo">
      
  <img src="../../assets/logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            energy-repset
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Diagnostics
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/helgeesch/energy-repset" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    helgeesch/energy-repset
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../examples/" class="md-tabs__link">
        
  
  
    
  
  Examples

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="energy-repset" class="md-nav__button md-logo" aria-label="energy-repset" data-md-component="logo">
      
  <img src="../../assets/logo-white.svg" alt="logo">

    </a>
    energy-repset
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/helgeesch/energy-repset" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    helgeesch/energy-repset
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Home
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    energy-repset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unified_framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unified Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modules & Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../constructive_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constructive Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advisor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration Advisor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex1_getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 1: Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex2_feature_space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 2: Feature Space Exploration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex3_hierarchical_selection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 3: Hierarchical Seasonal Selection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex4_representation_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 4: Comparing Representation Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex5_multi_objective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 5: Multi-Objective Exploration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/ex6_constructive_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Example 6: Constructive Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context & Slicing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow & Experiment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature_engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature Engineering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../objectives/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Objectives
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../score_components/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Score Components
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../combi_gens/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Combination Generators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../selection_policies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Selection Policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search_algorithms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Algorithms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../representation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Representation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Diagnostics
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagnostics
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature-space" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature Space
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature Space">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatter2D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatter2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatter3D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatter3D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatterMatrix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatterMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCAVarianceExplained
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCAVarianceExplained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureCorrelationHeatmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCorrelationHeatmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureDistributions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureDistributions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#score-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Score Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF" class="md-nav__link">
    <span class="md-ellipsis">
      
        DistributionOverlayECDF
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionOverlayECDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram" class="md-nav__link">
    <span class="md-ellipsis">
      
        DistributionOverlayHistogram
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionOverlayHistogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        CorrelationDifferenceHeatmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrelationDifferenceHeatmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiurnalProfileOverlay
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiurnalProfileOverlay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponsibilityBars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResponsibilityBars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoScatter2D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoScatter2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoScatterMatrix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoScatterMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoParallelCoordinates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoParallelCoordinates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ScoreContributionBars" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScoreContributionBars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ScoreContributionBars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ScoreContributionBars.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature-space" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature Space
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature Space">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatter2D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatter2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatter3D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatter3D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureSpaceScatterMatrix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureSpaceScatterMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained" class="md-nav__link">
    <span class="md-ellipsis">
      
        PCAVarianceExplained
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PCAVarianceExplained">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureCorrelationHeatmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureCorrelationHeatmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions" class="md-nav__link">
    <span class="md-ellipsis">
      
        FeatureDistributions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureDistributions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#score-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Score Components
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Score Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF" class="md-nav__link">
    <span class="md-ellipsis">
      
        DistributionOverlayECDF
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionOverlayECDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram" class="md-nav__link">
    <span class="md-ellipsis">
      
        DistributionOverlayHistogram
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionOverlayHistogram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        CorrelationDifferenceHeatmap
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrelationDifferenceHeatmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay" class="md-nav__link">
    <span class="md-ellipsis">
      
        DiurnalProfileOverlay
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiurnalProfileOverlay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    <span class="md-ellipsis">
      
        Results
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Results">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponsibilityBars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ResponsibilityBars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ResponsibilityBars.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoScatter2D
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoScatter2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatter2D.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoScatterMatrix
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoScatterMatrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates" class="md-nav__link">
    <span class="md-ellipsis">
      
        ParetoParallelCoordinates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParetoParallelCoordinates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ScoreContributionBars" class="md-nav__link">
    <span class="md-ellipsis">
      
        ScoreContributionBars
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ScoreContributionBars">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#energy_repset.diagnostics.results.ScoreContributionBars.plot" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="diagnostics">Diagnostics<a class="headerlink" href="#diagnostics" title="Permanent link">&para;</a></h1>
<h2 id="feature-space">Feature Space<a class="headerlink" href="#feature-space" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">FeatureSpaceScatter2D</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>2D scatter plot for visualizing feature space.</p>
<p>Creates an interactive scatter plot of any two features from df_features.
Can highlight a specific selection of slices. Works with any feature columns
including PCA components ('pc_0', 'pc_1'), statistical features ('mean__wind'),
or mixed features.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Visualize PCA space
&gt;&gt;&gt; scatter = FeatureSpaceScatter2D()
&gt;&gt;&gt; fig = scatter.plot(context.df_features, x=&#39;pc_0&#39;, y=&#39;pc_1&#39;)
&gt;&gt;&gt; fig.update_layout(title=&#39;PCA Feature Space&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Visualize with selection highlighted
&gt;&gt;&gt; fig = scatter.plot(
...     context.df_features,
...     x=&#39;mean__demand&#39;,
...     y=&#39;pc_0&#39;,
...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;, &#39;2024-07&#39;)
... )

&gt;&gt;&gt; # Color by another feature
&gt;&gt;&gt; fig = scatter.plot(
...     context.df_features,
...     x=&#39;pc_0&#39;,
...     y=&#39;pc_1&#39;,
...     color=&#39;std__wind&#39;
... )
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FeatureSpaceScatter2D</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;2D scatter plot for visualizing feature space.</span>

<span class="sd">    Creates an interactive scatter plot of any two features from df_features.</span>
<span class="sd">    Can highlight a specific selection of slices. Works with any feature columns</span>
<span class="sd">    including PCA components (&#39;pc_0&#39;, &#39;pc_1&#39;), statistical features (&#39;mean__wind&#39;),</span>
<span class="sd">    or mixed features.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Visualize PCA space</span>
<span class="sd">        &gt;&gt;&gt; scatter = FeatureSpaceScatter2D()</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(context.df_features, x=&#39;pc_0&#39;, y=&#39;pc_1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;PCA Feature Space&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Visualize with selection highlighted</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     x=&#39;mean__demand&#39;,</span>
<span class="sd">        ...     y=&#39;pc_0&#39;,</span>
<span class="sd">        ...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;, &#39;2024-07&#39;)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Color by another feature</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     x=&#39;pc_0&#39;,</span>
<span class="sd">        ...     y=&#39;pc_1&#39;,</span>
<span class="sd">        ...     color=&#39;std__wind&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the scatter plot diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a 2D scatter plot of feature space.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">            x: Column name for x-axis.</span>
<span class="sd">            y: Column name for y-axis.</span>
<span class="sd">            selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">            color: Optional column name to use for color mapping.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If x, y, or color columns are not in df_features.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate columns</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

        <span class="c1"># Prepare data</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Add selection indicator</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create scatter plot</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Color by feature value</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Color by selection status</span>
            <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                    <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="c1"># Update layout for better readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the scatter plot diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the scatter plot diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter2D.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_features</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">selection</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a 2D scatter plot of feature space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_features</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix with slices as rows, features as columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional tuple of slice identifiers to highlight.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional column name to use for color mapping.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If x, y, or color columns are not in df_features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a 2D scatter plot of feature space.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">        x: Column name for x-axis.</span>
<span class="sd">        y: Column name for y-axis.</span>
<span class="sd">        selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">        color: Optional column name to use for color mapping.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If x, y, or color columns are not in df_features.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate columns</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare data</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Add selection indicator</span>
    <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Create scatter plot</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Color by feature value</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">plot_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Color by selection status</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="c1"># Update layout for better readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">FeatureSpaceScatter3D</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>3D scatter plot for visualizing feature space.</p>
<p>Creates an interactive 3D scatter plot of any three features from df_features.
Can highlight a specific selection of slices. Works with any feature columns
including PCA components or statistical features.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Visualize 3D PCA space
&gt;&gt;&gt; scatter = FeatureSpaceScatter3D()
&gt;&gt;&gt; fig = scatter.plot(
...     context.df_features,
...     x=&#39;pc_0&#39;,
...     y=&#39;pc_1&#39;,
...     z=&#39;pc_2&#39;
... )
&gt;&gt;&gt; fig.update_layout(title=&#39;3D PCA Space&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Highlight selection
&gt;&gt;&gt; fig = scatter.plot(
...     context.df_features,
...     x=&#39;pc_0&#39;,
...     y=&#39;pc_1&#39;,
...     z=&#39;pc_2&#39;,
...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;)
... )

&gt;&gt;&gt; # Color by feature value
&gt;&gt;&gt; fig = scatter.plot(
...     context.df_features,
...     x=&#39;pc_0&#39;,
...     y=&#39;pc_1&#39;,
...     z=&#39;pc_2&#39;,
...     color=&#39;mean__demand&#39;
... )
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FeatureSpaceScatter3D</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;3D scatter plot for visualizing feature space.</span>

<span class="sd">    Creates an interactive 3D scatter plot of any three features from df_features.</span>
<span class="sd">    Can highlight a specific selection of slices. Works with any feature columns</span>
<span class="sd">    including PCA components or statistical features.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Visualize 3D PCA space</span>
<span class="sd">        &gt;&gt;&gt; scatter = FeatureSpaceScatter3D()</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     x=&#39;pc_0&#39;,</span>
<span class="sd">        ...     y=&#39;pc_1&#39;,</span>
<span class="sd">        ...     z=&#39;pc_2&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;3D PCA Space&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Highlight selection</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     x=&#39;pc_0&#39;,</span>
<span class="sd">        ...     y=&#39;pc_1&#39;,</span>
<span class="sd">        ...     z=&#39;pc_2&#39;,</span>
<span class="sd">        ...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Color by feature value</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     x=&#39;pc_0&#39;,</span>
<span class="sd">        ...     y=&#39;pc_1&#39;,</span>
<span class="sd">        ...     z=&#39;pc_2&#39;,</span>
<span class="sd">        ...     color=&#39;mean__demand&#39;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the 3D scatter plot diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">z</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a 3D scatter plot of feature space.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">            x: Column name for x-axis.</span>
<span class="sd">            y: Column name for y-axis.</span>
<span class="sd">            z: Column name for z-axis.</span>
<span class="sd">            selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">            color: Optional column name to use for color mapping.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If x, y, z, or color columns are not in df_features.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate columns</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

        <span class="c1"># Prepare data</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Add selection indicator</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create 3D scatter plot</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Color by feature value</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Color by selection status</span>
            <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                    <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="c1"># Update layout for better readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">zaxis_title</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the 3D scatter plot diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the 3D scatter plot diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatter3D.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_features</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">selection</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a 3D scatter plot of feature space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_features</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix with slices as rows, features as columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>z</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column name for z-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional tuple of slice identifiers to highlight.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional column name to use for color mapping.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If x, y, z, or color columns are not in df_features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">z</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a 3D scatter plot of feature space.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">        x: Column name for x-axis.</span>
<span class="sd">        y: Column name for y-axis.</span>
<span class="sd">        z: Column name for z-axis.</span>
<span class="sd">        selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">        color: Optional column name to use for color mapping.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If x, y, z, or color columns are not in df_features.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate columns</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">z</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare data</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Add selection indicator</span>
    <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Create 3D scatter plot</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Color by feature value</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
            <span class="n">plot_df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Color by selection status</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_3d</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="c1"># Update layout for better readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
            <span class="n">zaxis_title</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">FeatureSpaceScatterMatrix</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Scatter matrix (SPLOM) for visualizing relationships between multiple features.</p>
<p>Creates an interactive scatter plot matrix showing pairwise relationships between
all specified features. Can highlight a specific selection of slices. Useful for
exploring multi-dimensional feature spaces and identifying feature correlations.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Visualize PCA components
&gt;&gt;&gt; scatter_matrix = FeatureSpaceScatterMatrix()
&gt;&gt;&gt; fig = scatter_matrix.plot(
...     context.df_features,
...     dimensions=[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;pc_2&#39;]
... )
&gt;&gt;&gt; fig.update_layout(title=&#39;PCA Component Relationships&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Visualize statistical features with selection
&gt;&gt;&gt; fig = scatter_matrix.plot(
...     context.df_features,
...     dimensions=[&#39;mean__demand&#39;, &#39;std__demand&#39;, &#39;max__wind&#39;],
...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;, &#39;2024-07&#39;)
... )

&gt;&gt;&gt; # Color by a feature value
&gt;&gt;&gt; fig = scatter_matrix.plot(
...     context.df_features,
...     dimensions=[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;pc_2&#39;, &#39;pc_3&#39;],
...     color=&#39;mean__demand&#39;
... )

&gt;&gt;&gt; # All features
&gt;&gt;&gt; fig = scatter_matrix.plot(context.df_features)
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter_matrix.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FeatureSpaceScatterMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scatter matrix (SPLOM) for visualizing relationships between multiple features.</span>

<span class="sd">    Creates an interactive scatter plot matrix showing pairwise relationships between</span>
<span class="sd">    all specified features. Can highlight a specific selection of slices. Useful for</span>
<span class="sd">    exploring multi-dimensional feature spaces and identifying feature correlations.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Visualize PCA components</span>
<span class="sd">        &gt;&gt;&gt; scatter_matrix = FeatureSpaceScatterMatrix()</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter_matrix.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     dimensions=[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;pc_2&#39;]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;PCA Component Relationships&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Visualize statistical features with selection</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter_matrix.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     dimensions=[&#39;mean__demand&#39;, &#39;std__demand&#39;, &#39;max__wind&#39;],</span>
<span class="sd">        ...     selection=(&#39;2024-01&#39;, &#39;2024-04&#39;, &#39;2024-07&#39;)</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Color by a feature value</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter_matrix.plot(</span>
<span class="sd">        ...     context.df_features,</span>
<span class="sd">        ...     dimensions=[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;pc_2&#39;, &#39;pc_3&#39;],</span>
<span class="sd">        ...     color=&#39;mean__demand&#39;</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # All features</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter_matrix.plot(context.df_features)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the scatter matrix diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">dimensions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a scatter plot matrix of feature space.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">            dimensions: List of column names to include in the matrix. If None,</span>
<span class="sd">                uses all columns (may be slow for many features).</span>
<span class="sd">            selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">            color: Optional column name to use for color mapping. If None and</span>
<span class="sd">                selection is provided, colors by selection status.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If any dimension or color column is not in df_features.</span>
<span class="sd">            ValueError: If dimensions list is empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Handle dimensions default</span>
        <span class="k">if</span> <span class="n">dimensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dimensions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dimensions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimensions list cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># Validate columns</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

        <span class="c1"># Prepare data</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="p">[</span><span class="n">dimensions</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

        <span class="c1"># Add selection indicator</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
            <span class="c1"># Order so selected points are drawn on top</span>
            <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
                <span class="n">plot_df</span><span class="p">[</span><span class="o">~</span><span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]],</span>
                <span class="n">plot_df</span><span class="p">[</span><span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]]</span>
            <span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Create scatter matrix</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Color by feature value</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Color by selection status</span>
            <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                    <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
                    <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                    <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">},</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
                    <span class="n">plot_df</span><span class="p">,</span>
                    <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                    <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="p">)</span>

        <span class="c1"># Update layout for better readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">diagonal_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">showupperhalf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the scatter matrix diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter_matrix.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the scatter matrix diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureSpaceScatterMatrix.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_features</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">dimensions</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">selection</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a scatter plot matrix of feature space.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_features</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix with slices as rows, features as columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dimensions</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of column names to include in the matrix. If None,
uses all columns (may be slow for many features).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional tuple of slice identifiers to highlight.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional column name to use for color mapping. If None and
selection is provided, colors by selection status.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any dimension or color column is not in df_features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dimensions list is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_space_scatter_matrix.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">selection</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a scatter plot matrix of feature space.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">        dimensions: List of column names to include in the matrix. If None,</span>
<span class="sd">            uses all columns (may be slow for many features).</span>
<span class="sd">        selection: Optional tuple of slice identifiers to highlight.</span>
<span class="sd">        color: Optional column name to use for color mapping. If None and</span>
<span class="sd">            selection is provided, colors by selection status.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If any dimension or color column is not in df_features.</span>
<span class="sd">        ValueError: If dimensions list is empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Handle dimensions default</span>
    <span class="k">if</span> <span class="n">dimensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dimensions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimensions list cannot be empty&quot;</span><span class="p">)</span>

    <span class="c1"># Validate columns</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column &#39;</span><span class="si">{</span><span class="n">color</span><span class="si">}</span><span class="s2">&#39; not found in df_features&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare data</span>
    <span class="n">plot_df</span> <span class="o">=</span> <span class="n">df_features</span><span class="p">[</span><span class="n">dimensions</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="c1"># Add selection indicator</span>
    <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selection_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selection</span><span class="p">)</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selection_set</span><span class="p">)</span>
        <span class="c1"># Order so selected points are drawn on top</span>
        <span class="n">plot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="o">~</span><span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]],</span>
            <span class="n">plot_df</span><span class="p">[</span><span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]]</span>
        <span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;is_selected&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Create scatter matrix</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Color by feature value</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
            <span class="n">plot_df</span><span class="p">,</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">}</span> <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Color by selection status</span>
        <span class="k">if</span> <span class="n">selection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
                <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">},</span>
                <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;is_selected&#39;</span><span class="p">,</span>
                <span class="n">symbol_map</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="s1">&#39;star&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span>
                <span class="n">plot_df</span><span class="p">,</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">hover_data</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;slice_label&#39;</span><span class="p">],</span>
            <span class="p">)</span>

    <span class="c1"># Update layout for better readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">diagonal_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">showupperhalf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.PCAVarianceExplained" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">PCAVarianceExplained</span>


<a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Visualize explained variance ratio for PCA components.</p>
<p>Creates a bar chart showing the proportion of variance explained by each
principal component, along with cumulative variance. Helps determine how
many components are needed to capture most of the data's variance.</p>
<p>This diagnostic requires the fitted PCAFeatureEngineer instance to access
the explained_variance_ratio_ attribute.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Get PCA engineer from pipeline
&gt;&gt;&gt; pca_engineer = pipeline.engineers[&#39;pca&#39;]
&gt;&gt;&gt; variance_plot = PCAVarianceExplained(pca_engineer)
&gt;&gt;&gt; fig = variance_plot.plot()
&gt;&gt;&gt; fig.update_layout(title=&#39;PCA Variance Explained&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # With custom number of components shown
&gt;&gt;&gt; fig = variance_plot.plot(n_components=10)

&gt;&gt;&gt; # After running workflow
&gt;&gt;&gt; context_with_features = workflow.feature_engineer.run(context)
&gt;&gt;&gt; pca_eng = workflow.feature_engineer.engineers[&#39;pca&#39;]
&gt;&gt;&gt; variance_plot = PCAVarianceExplained(pca_eng)
&gt;&gt;&gt; fig = variance_plot.plot()
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/pca_variance_explained.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PCAVarianceExplained</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize explained variance ratio for PCA components.</span>

<span class="sd">    Creates a bar chart showing the proportion of variance explained by each</span>
<span class="sd">    principal component, along with cumulative variance. Helps determine how</span>
<span class="sd">    many components are needed to capture most of the data&#39;s variance.</span>

<span class="sd">    This diagnostic requires the fitted PCAFeatureEngineer instance to access</span>
<span class="sd">    the explained_variance_ratio_ attribute.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Get PCA engineer from pipeline</span>
<span class="sd">        &gt;&gt;&gt; pca_engineer = pipeline.engineers[&#39;pca&#39;]</span>
<span class="sd">        &gt;&gt;&gt; variance_plot = PCAVarianceExplained(pca_engineer)</span>
<span class="sd">        &gt;&gt;&gt; fig = variance_plot.plot()</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;PCA Variance Explained&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # With custom number of components shown</span>
<span class="sd">        &gt;&gt;&gt; fig = variance_plot.plot(n_components=10)</span>

<span class="sd">        &gt;&gt;&gt; # After running workflow</span>
<span class="sd">        &gt;&gt;&gt; context_with_features = workflow.feature_engineer.run(context)</span>
<span class="sd">        &gt;&gt;&gt; pca_eng = workflow.feature_engineer.engineers[&#39;pca&#39;]</span>
<span class="sd">        &gt;&gt;&gt; variance_plot = PCAVarianceExplained(pca_eng)</span>
<span class="sd">        &gt;&gt;&gt; fig = variance_plot.plot()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pca_engineer</span><span class="p">:</span> <span class="n">PCAFeatureEngineer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the PCA variance explained diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            pca_engineer: A fitted PCAFeatureEngineer instance. Must have been</span>
<span class="sd">                fitted on data (i.e., calc_and_get_features_df has been called).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span> <span class="o">=</span> <span class="n">pca_engineer</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a bar chart of explained variance ratios.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_components: Number of components to show. If None, shows all components.</span>
<span class="sd">            show_cumulative: If True, adds a line showing cumulative variance explained.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AttributeError: If the PCA engineer has not been fitted yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get variance ratios</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span><span class="p">,</span> <span class="s1">&#39;explained_variance_ratio_&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;PCA engineer has not been fitted. Call calc_and_get_features_df() first.&quot;</span>
            <span class="p">)</span>

        <span class="n">variance_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>

        <span class="c1"># Limit to requested number of components</span>
        <span class="k">if</span> <span class="n">n_components</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">variance_ratio</span><span class="p">[:</span><span class="n">n_components</span><span class="p">]</span>

        <span class="c1"># Prepare data</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variance_ratio</span><span class="p">)</span>
        <span class="n">component_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
        <span class="n">cumulative_variance</span> <span class="o">=</span> <span class="n">variance_ratio</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="c1"># Add variance bars</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">component_labels</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">variance_ratio</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Individual&#39;</span><span class="p">,</span>
            <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1%</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variance_ratio</span><span class="p">],</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
        <span class="p">))</span>

        <span class="c1"># Add cumulative line if requested</span>
        <span class="k">if</span> <span class="n">show_cumulative</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">component_labels</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">cumulative_variance</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cumulative&#39;</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1%</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cumulative_variance</span><span class="p">],</span>
                <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;top center&#39;</span><span class="p">,</span>
            <span class="p">))</span>

        <span class="c1"># Update layout</span>
        <span class="n">layout_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Principal Component&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Explained Variance Ratio&#39;</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">show_cumulative</span><span class="p">:</span>
            <span class="n">layout_kwargs</span><span class="p">[</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Cumulative Variance&#39;</span><span class="p">,</span>
                <span class="n">overlaying</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">,</span>
                <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">layout_kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.PCAVarianceExplained.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">pca_engineer</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            PCAFeatureEngineer (energy_repset.feature_engineering.pca.PCAFeatureEngineer)" href="../feature_engineering/#energy_repset.feature_engineering.PCAFeatureEngineer">PCAFeatureEngineer</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the PCA variance explained diagnostic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pca_engineer</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            PCAFeatureEngineer (energy_repset.feature_engineering.pca.PCAFeatureEngineer)" href="../feature_engineering/#energy_repset.feature_engineering.PCAFeatureEngineer">PCAFeatureEngineer</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A fitted PCAFeatureEngineer instance. Must have been
fitted on data (i.e., calc_and_get_features_df has been called).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/pca_variance_explained.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pca_engineer</span><span class="p">:</span> <span class="n">PCAFeatureEngineer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the PCA variance explained diagnostic.</span>

<span class="sd">    Args:</span>
<span class="sd">        pca_engineer: A fitted PCAFeatureEngineer instance. Must have been</span>
<span class="sd">            fitted on data (i.e., calc_and_get_features_df has been called).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span> <span class="o">=</span> <span class="n">pca_engineer</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.PCAVarianceExplained.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.PCAVarianceExplained.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">n_components</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_cumulative</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a bar chart of explained variance ratios.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_components</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of components to show. If None, shows all components.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_cumulative</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, adds a line showing cumulative variance explained.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AttributeError">AttributeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the PCA engineer has not been fitted yet.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/pca_variance_explained.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_cumulative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a bar chart of explained variance ratios.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_components: Number of components to show. If None, shows all components.</span>
<span class="sd">        show_cumulative: If True, adds a line showing cumulative variance explained.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AttributeError: If the PCA engineer has not been fitted yet.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get variance ratios</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span><span class="p">,</span> <span class="s1">&#39;explained_variance_ratio_&#39;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s2">&quot;PCA engineer has not been fitted. Call calc_and_get_features_df() first.&quot;</span>
        <span class="p">)</span>

    <span class="n">variance_ratio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pca_engineer</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>

    <span class="c1"># Limit to requested number of components</span>
    <span class="k">if</span> <span class="n">n_components</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">variance_ratio</span> <span class="o">=</span> <span class="n">variance_ratio</span><span class="p">[:</span><span class="n">n_components</span><span class="p">]</span>

    <span class="c1"># Prepare data</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variance_ratio</span><span class="p">)</span>
    <span class="n">component_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;PC</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">cumulative_variance</span> <span class="o">=</span> <span class="n">variance_ratio</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add variance bars</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">component_labels</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">variance_ratio</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Individual&#39;</span><span class="p">,</span>
        <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1%</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variance_ratio</span><span class="p">],</span>
        <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span>
    <span class="p">))</span>

    <span class="c1"># Add cumulative line if requested</span>
    <span class="k">if</span> <span class="n">show_cumulative</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">component_labels</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">cumulative_variance</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cumulative&#39;</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.1%</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cumulative_variance</span><span class="p">],</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;top center&#39;</span><span class="p">,</span>
        <span class="p">))</span>

    <span class="c1"># Update layout</span>
    <span class="n">layout_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Principal Component&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Explained Variance Ratio&#39;</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">show_cumulative</span><span class="p">:</span>
        <span class="n">layout_kwargs</span><span class="p">[</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Cumulative Variance&#39;</span><span class="p">,</span>
            <span class="n">overlaying</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
            <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
            <span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">layout_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">FeatureCorrelationHeatmap</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Visualize correlation matrix of features.</p>
<p>Creates an interactive heatmap showing Pearson correlations between all features
in the feature matrix. Helps identify redundant features and understand feature
relationships. Can optionally show only the lower triangle to avoid redundancy.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Visualize all feature correlations
&gt;&gt;&gt; heatmap = FeatureCorrelationHeatmap()
&gt;&gt;&gt; fig = heatmap.plot(context.df_features)
&gt;&gt;&gt; fig.update_layout(title=&#39;Feature Correlation Matrix&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Show only lower triangle
&gt;&gt;&gt; fig = heatmap.plot(context.df_features, show_lower_only=True)

&gt;&gt;&gt; # Subset of features
&gt;&gt;&gt; selected_features = context.df_features[[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;mean__demand&#39;]]
&gt;&gt;&gt; fig = heatmap.plot(selected_features)
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_correlation_heatmap.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FeatureCorrelationHeatmap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize correlation matrix of features.</span>

<span class="sd">    Creates an interactive heatmap showing Pearson correlations between all features</span>
<span class="sd">    in the feature matrix. Helps identify redundant features and understand feature</span>
<span class="sd">    relationships. Can optionally show only the lower triangle to avoid redundancy.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Visualize all feature correlations</span>
<span class="sd">        &gt;&gt;&gt; heatmap = FeatureCorrelationHeatmap()</span>
<span class="sd">        &gt;&gt;&gt; fig = heatmap.plot(context.df_features)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Feature Correlation Matrix&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Show only lower triangle</span>
<span class="sd">        &gt;&gt;&gt; fig = heatmap.plot(context.df_features, show_lower_only=True)</span>

<span class="sd">        &gt;&gt;&gt; # Subset of features</span>
<span class="sd">        &gt;&gt;&gt; selected_features = context.df_features[[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;mean__demand&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; fig = heatmap.plot(selected_features)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the feature correlation heatmap diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
        <span class="n">show_lower_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a heatmap of feature correlations.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">            method: Correlation method (&#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;).</span>
<span class="sd">                Default is &#39;pearson&#39;.</span>
<span class="sd">            show_lower_only: If True, shows only the lower triangle of the</span>
<span class="sd">                correlation matrix (removes redundant upper triangle and diagonal).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If method is not one of the supported correlation methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">,</span> <span class="s1">&#39;kendall&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;method must be &#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;, got &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Calculate correlation matrix</span>
        <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

        <span class="c1"># Mask upper triangle if requested</span>
        <span class="k">if</span> <span class="n">show_lower_only</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">)</span>
            <span class="c1"># Set upper triangle and diagonal to True (to be masked)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">)):</span>
                    <span class="n">mask</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Apply mask by setting values to NaN</span>
            <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">)</span>

        <span class="c1"># Create heatmap</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">corr_matrix</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
            <span class="n">color_continuous_midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">zmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">zmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update layout for better readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">coloraxis_colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Correlation&#39;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Improve text readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the feature correlation heatmap diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_correlation_heatmap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the feature correlation heatmap diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureCorrelationHeatmap.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_features</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">show_lower_only</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a heatmap of feature correlations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_features</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix with slices as rows, features as columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Correlation method ('pearson', 'spearman', or 'kendall').
Default is 'pearson'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pearson&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_lower_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, shows only the lower triangle of the
correlation matrix (removes redundant upper triangle and diagonal).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If method is not one of the supported correlation methods.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_correlation_heatmap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
    <span class="n">show_lower_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a heatmap of feature correlations.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">        method: Correlation method (&#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;).</span>
<span class="sd">            Default is &#39;pearson&#39;.</span>
<span class="sd">        show_lower_only: If True, shows only the lower triangle of the</span>
<span class="sd">            correlation matrix (removes redundant upper triangle and diagonal).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If method is not one of the supported correlation methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">,</span> <span class="s1">&#39;kendall&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;method must be &#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;, got &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Calculate correlation matrix</span>
    <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_features</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="c1"># Mask upper triangle if requested</span>
    <span class="k">if</span> <span class="n">show_lower_only</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">)</span>
        <span class="c1"># Set upper triangle and diagonal to True (to be masked)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">)):</span>
                <span class="n">mask</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Apply mask by setting values to NaN</span>
        <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Create heatmap</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">corr_matrix</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
        <span class="n">color_continuous_midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">zmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">zmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Update layout for better readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">coloraxis_colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Correlation&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Improve text readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">text</span><span class="o">=</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.feature_space.FeatureDistributions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">FeatureDistributions</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureDistributions" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Visualize distributions of all features as histograms.</p>
<p>Creates a grid of histograms showing the distribution of each feature across
all slices. Helps identify feature scales, skewness, and potential outliers.
Useful for understanding the feature space before selection.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Visualize all feature distributions
&gt;&gt;&gt; dist_plot = FeatureDistributions()
&gt;&gt;&gt; fig = dist_plot.plot(context.df_features)
&gt;&gt;&gt; fig.update_layout(title=&#39;Feature Distributions&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Subset of features
&gt;&gt;&gt; selected_features = context.df_features[[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;mean__demand&#39;]]
&gt;&gt;&gt; fig = dist_plot.plot(selected_features)

&gt;&gt;&gt; # With custom bin count
&gt;&gt;&gt; fig = dist_plot.plot(context.df_features, nbins=30)
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_distributions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FeatureDistributions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize distributions of all features as histograms.</span>

<span class="sd">    Creates a grid of histograms showing the distribution of each feature across</span>
<span class="sd">    all slices. Helps identify feature scales, skewness, and potential outliers.</span>
<span class="sd">    Useful for understanding the feature space before selection.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Visualize all feature distributions</span>
<span class="sd">        &gt;&gt;&gt; dist_plot = FeatureDistributions()</span>
<span class="sd">        &gt;&gt;&gt; fig = dist_plot.plot(context.df_features)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Feature Distributions&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Subset of features</span>
<span class="sd">        &gt;&gt;&gt; selected_features = context.df_features[[&#39;pc_0&#39;, &#39;pc_1&#39;, &#39;mean__demand&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; fig = dist_plot.plot(selected_features)</span>

<span class="sd">        &gt;&gt;&gt; # With custom bin count</span>
<span class="sd">        &gt;&gt;&gt; fig = dist_plot.plot(context.df_features, nbins=30)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the feature distributions diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">nbins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a grid of histograms for all features.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">            nbins: Number of bins for each histogram. Default is 20.</span>
<span class="sd">            cols: Number of columns in the subplot grid. Default is 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If df_features is empty or nbins/cols are invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">df_features</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_features cannot be empty&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nbins</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nbins must be positive&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cols</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cols must be positive&quot;</span><span class="p">)</span>

        <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">n_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># Calculate grid dimensions</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_features</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">cols</span>  <span class="c1"># Ceiling division</span>

        <span class="c1"># Create subplots</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
            <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
            <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.12</span> <span class="o">/</span> <span class="n">rows</span> <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.1</span><span class="p">,</span>
            <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Add histogram for each feature</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">df_features</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span>
                    <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Update axes labels</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

        <span class="c1"># Update overall layout</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">300</span> <span class="o">*</span> <span class="n">rows</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureDistributions.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the feature distributions diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_distributions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the feature distributions diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.feature_space.FeatureDistributions.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.feature_space.FeatureDistributions.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_features</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">nbins</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cols</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a grid of histograms for all features.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_features</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature matrix with slices as rows, features as columns.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nbins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bins for each histogram. Default is 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cols</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of columns in the subplot grid. Default is 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If df_features is empty or nbins/cols are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/feature_space/feature_distributions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_features</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nbins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a grid of histograms for all features.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_features: Feature matrix with slices as rows, features as columns.</span>
<span class="sd">        nbins: Number of bins for each histogram. Default is 20.</span>
<span class="sd">        cols: Number of columns in the subplot grid. Default is 3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If df_features is empty or nbins/cols are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">df_features</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_features cannot be empty&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nbins</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nbins must be positive&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cols</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;cols must be positive&quot;</span><span class="p">)</span>

    <span class="n">features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_features</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">n_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="c1"># Calculate grid dimensions</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_features</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">cols</span>  <span class="c1"># Ceiling division</span>

    <span class="c1"># Create subplots</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
        <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
        <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
        <span class="n">subplot_titles</span><span class="o">=</span><span class="n">features</span><span class="p">,</span>
        <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.12</span> <span class="o">/</span> <span class="n">rows</span> <span class="k">if</span> <span class="n">rows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.1</span> <span class="o">/</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">cols</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add histogram for each feature</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">//</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">cols</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">df_features</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span>
                <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update axes labels</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="n">feature</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

    <span class="c1"># Update overall layout</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">300</span> <span class="o">*</span> <span class="n">rows</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="score-components">Score Components<a class="headerlink" href="#score-components" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.score_components.DistributionOverlayECDF" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DistributionOverlayECDF</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Overlay empirical cumulative distribution functions (ECDF) to compare distributions.</p>
<p>Creates a plot showing the ECDF of a variable for both the full dataset and
a selection. This helps visualize how well the selection represents the full
distribution, which is what WassersteinFidelity measures.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Compare demand distribution
&gt;&gt;&gt; ecdf_plot = DistributionOverlayECDF()
&gt;&gt;&gt; full_data = context.df_raw[&#39;demand&#39;]
&gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)
&gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, &#39;demand&#39;]
&gt;&gt;&gt; fig = ecdf_plot.plot(full_data, selected_data)
&gt;&gt;&gt; fig.update_layout(title=&#39;Demand Distribution: Full vs Selected&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Alternative: using iloc
&gt;&gt;&gt; selection_mask = context.df_raw.index.isin(selected_indices)
&gt;&gt;&gt; fig = ecdf_plot.plot(
...     context.df_raw[&#39;wind&#39;],
...     context.df_raw.loc[selection_mask, &#39;wind&#39;]
... )
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DistributionOverlayECDF</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlay empirical cumulative distribution functions (ECDF) to compare distributions.</span>

<span class="sd">    Creates a plot showing the ECDF of a variable for both the full dataset and</span>
<span class="sd">    a selection. This helps visualize how well the selection represents the full</span>
<span class="sd">    distribution, which is what WassersteinFidelity measures.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Compare demand distribution</span>
<span class="sd">        &gt;&gt;&gt; ecdf_plot = DistributionOverlayECDF()</span>
<span class="sd">        &gt;&gt;&gt; full_data = context.df_raw[&#39;demand&#39;]</span>
<span class="sd">        &gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)</span>
<span class="sd">        &gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, &#39;demand&#39;]</span>
<span class="sd">        &gt;&gt;&gt; fig = ecdf_plot.plot(full_data, selected_data)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Demand Distribution: Full vs Selected&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Alternative: using iloc</span>
<span class="sd">        &gt;&gt;&gt; selection_mask = context.df_raw.index.isin(selected_indices)</span>
<span class="sd">        &gt;&gt;&gt; fig = ecdf_plot.plot(</span>
<span class="sd">        ...     context.df_raw[&#39;wind&#39;],</span>
<span class="sd">        ...     context.df_raw.loc[selection_mask, &#39;wind&#39;]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the ECDF overlay diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
        <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an ECDF overlay plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_full: Series containing values for the full dataset.</span>
<span class="sd">            df_selection: Series containing values for the selection.</span>
<span class="sd">            full_label: Label for the full dataset in the legend. Default &#39;Full&#39;.</span>
<span class="sd">            selection_label: Label for the selection in the legend. Default &#39;Selection&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Drop NaN values</span>
        <span class="n">full_values</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        <span class="n">selection_values</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Calculate ECDF for full dataset</span>
        <span class="n">full_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">full_values</span><span class="p">)</span>
        <span class="n">full_ecdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_sorted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_sorted</span><span class="p">)</span>

        <span class="c1"># Calculate ECDF for selection</span>
        <span class="n">selection_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">selection_values</span><span class="p">)</span>
        <span class="n">selection_ecdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection_sorted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection_sorted</span><span class="p">)</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="c1"># Add full dataset ECDF</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">full_sorted</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">full_ecdf</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">full_label</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">))</span>

        <span class="c1"># Add selection ECDF</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">selection_sorted</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">selection_ecdf</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">selection_label</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
        <span class="p">))</span>

        <span class="c1"># Update layout</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">df_full</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Cumulative Probability&#39;</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
            <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DistributionOverlayECDF.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the ECDF overlay diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the ECDF overlay diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DistributionOverlayECDF.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayECDF.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_full</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n">df_selection</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n">full_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="n">selection_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an ECDF overlay plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_full</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series containing values for the full dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_selection</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series containing values for the selection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the full dataset in the legend. Default 'Full'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the selection in the legend. Default 'Selection'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Selection&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
    <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an ECDF overlay plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_full: Series containing values for the full dataset.</span>
<span class="sd">        df_selection: Series containing values for the selection.</span>
<span class="sd">        full_label: Label for the full dataset in the legend. Default &#39;Full&#39;.</span>
<span class="sd">        selection_label: Label for the selection in the legend. Default &#39;Selection&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Drop NaN values</span>
    <span class="n">full_values</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">selection_values</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Calculate ECDF for full dataset</span>
    <span class="n">full_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">full_values</span><span class="p">)</span>
    <span class="n">full_ecdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_sorted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_sorted</span><span class="p">)</span>

    <span class="c1"># Calculate ECDF for selection</span>
    <span class="n">selection_sorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">selection_values</span><span class="p">)</span>
    <span class="n">selection_ecdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection_sorted</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">selection_sorted</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add full dataset ECDF</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">full_sorted</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">full_ecdf</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">full_label</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">))</span>

    <span class="c1"># Add selection ECDF</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">selection_sorted</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">selection_ecdf</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">selection_label</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
    <span class="p">))</span>

    <span class="c1"># Update layout</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="n">df_full</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Cumulative Probability&#39;</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">tickformat</span><span class="o">=</span><span class="s1">&#39;.0%&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.score_components.DistributionOverlayHistogram" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DistributionOverlayHistogram</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Overlay histograms to compare distributions.</p>
<p>Creates a plot showing normalized histograms of a variable for both the
full dataset and a selection. Alternative to ECDF that may be more intuitive
for some users. Shows probability density rather than cumulative probability.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Compare demand distribution
&gt;&gt;&gt; hist_plot = DistributionOverlayHistogram()
&gt;&gt;&gt; full_data = context.df_raw[&#39;demand&#39;]
&gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)
&gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, &#39;demand&#39;]
&gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data)
&gt;&gt;&gt; fig.update_layout(title=&#39;Demand Distribution: Full vs Selected&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # With custom bin count
&gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data, nbins=50)

&gt;&gt;&gt; # Using density mode
&gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data, histnorm=&#39;probability density&#39;)
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DistributionOverlayHistogram</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlay histograms to compare distributions.</span>

<span class="sd">    Creates a plot showing normalized histograms of a variable for both the</span>
<span class="sd">    full dataset and a selection. Alternative to ECDF that may be more intuitive</span>
<span class="sd">    for some users. Shows probability density rather than cumulative probability.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Compare demand distribution</span>
<span class="sd">        &gt;&gt;&gt; hist_plot = DistributionOverlayHistogram()</span>
<span class="sd">        &gt;&gt;&gt; full_data = context.df_raw[&#39;demand&#39;]</span>
<span class="sd">        &gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)</span>
<span class="sd">        &gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, &#39;demand&#39;]</span>
<span class="sd">        &gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Demand Distribution: Full vs Selected&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # With custom bin count</span>
<span class="sd">        &gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data, nbins=50)</span>

<span class="sd">        &gt;&gt;&gt; # Using density mode</span>
<span class="sd">        &gt;&gt;&gt; fig = hist_plot.plot(full_data, selected_data, histnorm=&#39;probability density&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the histogram overlay diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">nbins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="n">histnorm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;probability&#39;</span><span class="p">,</span>
        <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
        <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a histogram overlay plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_full: Series containing values for the full dataset.</span>
<span class="sd">            df_selection: Series containing values for the selection.</span>
<span class="sd">            nbins: Number of bins for the histogram. Default is 30.</span>
<span class="sd">            histnorm: Histogram normalization mode. Options: &#39;probability&#39;,</span>
<span class="sd">                &#39;probability density&#39;, &#39;percent&#39;. Default is &#39;probability&#39;.</span>
<span class="sd">            full_label: Label for the full dataset in the legend. Default &#39;Full&#39;.</span>
<span class="sd">            selection_label: Label for the selection in the legend. Default &#39;Selection&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If histnorm is not a valid option.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid_histnorms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="s1">&#39;probability density&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">histnorm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_histnorms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;histnorm must be one of </span><span class="si">{</span><span class="n">valid_histnorms</span><span class="si">}</span><span class="s2">, got &#39;</span><span class="si">{</span><span class="n">histnorm</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Drop NaN values</span>
        <span class="n">full_values</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
        <span class="n">selection_values</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="c1"># Add full dataset histogram</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">full_values</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">full_label</span><span class="p">,</span>
            <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
            <span class="n">histnorm</span><span class="o">=</span><span class="n">histnorm</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
        <span class="p">))</span>

        <span class="c1"># Add selection histogram</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">selection_values</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">selection_label</span><span class="p">,</span>
            <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
            <span class="n">histnorm</span><span class="o">=</span><span class="n">histnorm</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
        <span class="p">))</span>

        <span class="c1"># Update layout</span>
        <span class="n">yaxis_title</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
            <span class="s1">&#39;probability density&#39;</span><span class="p">:</span> <span class="s1">&#39;Probability Density&#39;</span><span class="p">,</span>
            <span class="s1">&#39;percent&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span>
        <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">histnorm</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="n">df_full</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">yaxis_title</span><span class="p">,</span>
            <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DistributionOverlayHistogram.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the histogram overlay diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the histogram overlay diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DistributionOverlayHistogram.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.score_components.DistributionOverlayHistogram.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_full</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n">df_selection</span><span class="p">:</span> <span class="n"><span title="pandas.Series">Series</span></span><span class="p">,</span> <span class="n">nbins</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">histnorm</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="n">full_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="n">selection_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a histogram overlay plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_full</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series containing values for the full dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_selection</code>
            </td>
            <td>
                  <code><span title="pandas.Series">Series</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series containing values for the selection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nbins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bins for the histogram. Default is 30.</p>
              </div>
            </td>
            <td>
                  <code>30</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>histnorm</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Histogram normalization mode. Options: 'probability',
'probability density', 'percent'. Default is 'probability'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;probability&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the full dataset in the legend. Default 'Full'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the selection in the legend. Default 'Selection'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Selection&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If histnorm is not a valid option.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/distribution_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">nbins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">histnorm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;probability&#39;</span><span class="p">,</span>
    <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
    <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a histogram overlay plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_full: Series containing values for the full dataset.</span>
<span class="sd">        df_selection: Series containing values for the selection.</span>
<span class="sd">        nbins: Number of bins for the histogram. Default is 30.</span>
<span class="sd">        histnorm: Histogram normalization mode. Options: &#39;probability&#39;,</span>
<span class="sd">            &#39;probability density&#39;, &#39;percent&#39;. Default is &#39;probability&#39;.</span>
<span class="sd">        full_label: Label for the full dataset in the legend. Default &#39;Full&#39;.</span>
<span class="sd">        selection_label: Label for the selection in the legend. Default &#39;Selection&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If histnorm is not a valid option.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_histnorms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="s1">&#39;probability density&#39;</span><span class="p">,</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">histnorm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_histnorms</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;histnorm must be one of </span><span class="si">{</span><span class="n">valid_histnorms</span><span class="si">}</span><span class="s2">, got &#39;</span><span class="si">{</span><span class="n">histnorm</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Drop NaN values</span>
    <span class="n">full_values</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
    <span class="n">selection_values</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add full dataset histogram</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">full_values</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">full_label</span><span class="p">,</span>
        <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
        <span class="n">histnorm</span><span class="o">=</span><span class="n">histnorm</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="p">))</span>

    <span class="c1"># Add selection histogram</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">selection_values</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">selection_label</span><span class="p">,</span>
        <span class="n">nbinsx</span><span class="o">=</span><span class="n">nbins</span><span class="p">,</span>
        <span class="n">histnorm</span><span class="o">=</span><span class="n">histnorm</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="p">))</span>

    <span class="c1"># Update layout</span>
    <span class="n">yaxis_title</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="s1">&#39;Probability&#39;</span><span class="p">,</span>
        <span class="s1">&#39;probability density&#39;</span><span class="p">:</span> <span class="s1">&#39;Probability Density&#39;</span><span class="p">,</span>
        <span class="s1">&#39;percent&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="s1">&#39;Count&#39;</span><span class="p">,</span>
    <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">histnorm</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="n">df_full</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="n">yaxis_title</span><span class="p">,</span>
        <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">CorrelationDifferenceHeatmap</span>


<a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Visualize the difference between correlation matrices.</p>
<p>Creates a heatmap showing the difference between the correlation matrix of
the full dataset and the selection. This helps identify which variable
relationships are well-preserved or poorly-preserved by the selection.
Related to CorrelationFidelity score component.</p>
<p>Positive values (red) indicate the selection has stronger correlation than
the full dataset. Negative values (blue) indicate weaker correlation.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Compare correlation structure
&gt;&gt;&gt; corr_diff = CorrelationDifferenceHeatmap()
&gt;&gt;&gt; full_data = context.df_raw[[&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]
&gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)
&gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, [&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]
&gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data)
&gt;&gt;&gt; fig.update_layout(title=&#39;Correlation Difference: Selection - Full&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # With Spearman correlation
&gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data, method=&#39;spearman&#39;)

&gt;&gt;&gt; # Show only lower triangle
&gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data, show_lower_only=True)
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/score_components/correlation_difference_heatmap.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CorrelationDifferenceHeatmap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualize the difference between correlation matrices.</span>

<span class="sd">    Creates a heatmap showing the difference between the correlation matrix of</span>
<span class="sd">    the full dataset and the selection. This helps identify which variable</span>
<span class="sd">    relationships are well-preserved or poorly-preserved by the selection.</span>
<span class="sd">    Related to CorrelationFidelity score component.</span>

<span class="sd">    Positive values (red) indicate the selection has stronger correlation than</span>
<span class="sd">    the full dataset. Negative values (blue) indicate weaker correlation.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Compare correlation structure</span>
<span class="sd">        &gt;&gt;&gt; corr_diff = CorrelationDifferenceHeatmap()</span>
<span class="sd">        &gt;&gt;&gt; full_data = context.df_raw[[&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)</span>
<span class="sd">        &gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, [&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Correlation Difference: Selection - Full&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # With Spearman correlation</span>
<span class="sd">        &gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data, method=&#39;spearman&#39;)</span>

<span class="sd">        &gt;&gt;&gt; # Show only lower triangle</span>
<span class="sd">        &gt;&gt;&gt; fig = corr_diff.plot(full_data, selected_data, show_lower_only=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the correlation difference heatmap diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
        <span class="n">show_lower_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a heatmap of correlation differences.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_full: DataFrame containing variables for the full dataset.</span>
<span class="sd">            df_selection: DataFrame containing variables for the selection.</span>
<span class="sd">                Must have the same columns as df_full.</span>
<span class="sd">            method: Correlation method (&#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;).</span>
<span class="sd">                Default is &#39;pearson&#39;.</span>
<span class="sd">            show_lower_only: If True, shows only the lower triangle of the</span>
<span class="sd">                difference matrix (removes redundant upper triangle and diagonal).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If method is invalid or columns don&#39;t match.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">,</span> <span class="s1">&#39;kendall&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;method must be &#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;, got &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;df_full and df_selection must have the same columns&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Calculate correlation matrices</span>
        <span class="n">corr_full</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="n">corr_selection</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

        <span class="c1"># Calculate difference (selection - full)</span>
        <span class="n">corr_diff</span> <span class="o">=</span> <span class="n">corr_selection</span> <span class="o">-</span> <span class="n">corr_full</span>

        <span class="c1"># Mask upper triangle if requested</span>
        <span class="k">if</span> <span class="n">show_lower_only</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="kc">False</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">columns</span>
            <span class="p">)</span>
            <span class="c1"># Set upper triangle and diagonal to True (to be masked)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corr_diff</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_diff</span><span class="p">)):</span>
                    <span class="n">mask</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Apply mask by setting values to NaN</span>
            <span class="n">corr_diff</span> <span class="o">=</span> <span class="n">corr_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">)</span>

        <span class="c1"># Determine color scale range (symmetric around 0)</span>
        <span class="n">max_abs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">max_abs</span><span class="p">):</span>
            <span class="n">max_abs</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># Create heatmap</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
            <span class="n">corr_diff</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
            <span class="n">color_continuous_midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">zmin</span><span class="o">=-</span><span class="n">max_abs</span><span class="p">,</span>
            <span class="n">zmax</span><span class="o">=</span><span class="n">max_abs</span><span class="p">,</span>
            <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update layout for better readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">coloraxis_colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39; Correlation&lt;br&gt;(Selection - Full)&#39;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Improve text readability</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">text</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the correlation difference heatmap diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/correlation_difference_heatmap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the correlation difference heatmap diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.score_components.CorrelationDifferenceHeatmap.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_full</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">df_selection</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="n">show_lower_only</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a heatmap of correlation differences.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_full</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing variables for the full dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_selection</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing variables for the selection.
Must have the same columns as df_full.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Correlation method ('pearson', 'spearman', or 'kendall').
Default is 'pearson'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pearson&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_lower_only</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, shows only the lower triangle of the
difference matrix (removes redundant upper triangle and diagonal).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If method is invalid or columns don't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/correlation_difference_heatmap.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pearson&#39;</span><span class="p">,</span>
    <span class="n">show_lower_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a heatmap of correlation differences.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_full: DataFrame containing variables for the full dataset.</span>
<span class="sd">        df_selection: DataFrame containing variables for the selection.</span>
<span class="sd">            Must have the same columns as df_full.</span>
<span class="sd">        method: Correlation method (&#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;).</span>
<span class="sd">            Default is &#39;pearson&#39;.</span>
<span class="sd">        show_lower_only: If True, shows only the lower triangle of the</span>
<span class="sd">            difference matrix (removes redundant upper triangle and diagonal).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If method is invalid or columns don&#39;t match.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman&#39;</span><span class="p">,</span> <span class="s1">&#39;kendall&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;method must be &#39;pearson&#39;, &#39;spearman&#39;, or &#39;kendall&#39;, got &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;df_full and df_selection must have the same columns&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Calculate correlation matrices</span>
    <span class="n">corr_full</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="n">corr_selection</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="c1"># Calculate difference (selection - full)</span>
    <span class="n">corr_diff</span> <span class="o">=</span> <span class="n">corr_selection</span> <span class="o">-</span> <span class="n">corr_full</span>

    <span class="c1"># Mask upper triangle if requested</span>
    <span class="k">if</span> <span class="n">show_lower_only</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">)</span>
        <span class="c1"># Set upper triangle and diagonal to True (to be masked)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">corr_diff</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_diff</span><span class="p">)):</span>
                <span class="n">mask</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Apply mask by setting values to NaN</span>
        <span class="n">corr_diff</span> <span class="o">=</span> <span class="n">corr_diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">)</span>

    <span class="c1"># Determine color scale range (symmetric around 0)</span>
    <span class="n">max_abs</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">max_abs</span><span class="p">):</span>
        <span class="n">max_abs</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># Create heatmap</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
        <span class="n">corr_diff</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">color_continuous_scale</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span>
        <span class="n">color_continuous_midpoint</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">zmin</span><span class="o">=-</span><span class="n">max_abs</span><span class="p">,</span>
        <span class="n">zmax</span><span class="o">=</span><span class="n">max_abs</span><span class="p">,</span>
        <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Update layout for better readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">coloraxis_colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39; Correlation&lt;br&gt;(Selection - Full)&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Improve text readability</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">text</span><span class="o">=</span><span class="n">corr_diff</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{text}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.score_components.DiurnalProfileOverlay" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">DiurnalProfileOverlay</span>


<a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Overlay mean diurnal (hour-of-day) profiles for full vs selected data.</p>
<p>Creates a plot showing the average value by hour of day for each variable,
comparing the full dataset to the selection. This helps visualize how well
the selection preserves daily patterns, which is related to DiurnalFidelity
score component.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; # Compare diurnal patterns
&gt;&gt;&gt; diurnal_plot = DiurnalProfileOverlay()
&gt;&gt;&gt; full_data = context.df_raw[[&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]
&gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)
&gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, [&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]
&gt;&gt;&gt; fig = diurnal_plot.plot(full_data, selected_data)
&gt;&gt;&gt; fig.update_layout(title=&#39;Diurnal Profiles: Full vs Selected&#39;)
&gt;&gt;&gt; fig.show()

&gt;&gt;&gt; # Single variable
&gt;&gt;&gt; fig = diurnal_plot.plot(
...     full_data[[&#39;demand&#39;]],
...     selected_data[[&#39;demand&#39;]]
... )

&gt;&gt;&gt; # Subset of variables
&gt;&gt;&gt; fig = diurnal_plot.plot(
...     full_data,
...     selected_data,
...     variables=[&#39;demand&#39;, &#39;wind&#39;]
... )
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/score_components/diurnal_profile_overlay.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiurnalProfileOverlay</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overlay mean diurnal (hour-of-day) profiles for full vs selected data.</span>

<span class="sd">    Creates a plot showing the average value by hour of day for each variable,</span>
<span class="sd">    comparing the full dataset to the selection. This helps visualize how well</span>
<span class="sd">    the selection preserves daily patterns, which is related to DiurnalFidelity</span>
<span class="sd">    score component.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; # Compare diurnal patterns</span>
<span class="sd">        &gt;&gt;&gt; diurnal_plot = DiurnalProfileOverlay()</span>
<span class="sd">        &gt;&gt;&gt; full_data = context.df_raw[[&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; selected_indices = context.slicer.get_indices_for_slices(result.selection)</span>
<span class="sd">        &gt;&gt;&gt; selected_data = context.df_raw.loc[selected_indices, [&#39;demand&#39;, &#39;wind&#39;, &#39;solar&#39;]]</span>
<span class="sd">        &gt;&gt;&gt; fig = diurnal_plot.plot(full_data, selected_data)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Diurnal Profiles: Full vs Selected&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>

<span class="sd">        &gt;&gt;&gt; # Single variable</span>
<span class="sd">        &gt;&gt;&gt; fig = diurnal_plot.plot(</span>
<span class="sd">        ...     full_data[[&#39;demand&#39;]],</span>
<span class="sd">        ...     selected_data[[&#39;demand&#39;]]</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; # Subset of variables</span>
<span class="sd">        &gt;&gt;&gt; fig = diurnal_plot.plot(</span>
<span class="sd">        ...     full_data,</span>
<span class="sd">        ...     selected_data,</span>
<span class="sd">        ...     variables=[&#39;demand&#39;, &#39;wind&#39;]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the diurnal profile overlay diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
        <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a diurnal profile overlay plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            df_full: DataFrame with DatetimeIndex and variable columns for full dataset.</span>
<span class="sd">            df_selection: DataFrame with DatetimeIndex and variable columns for selection.</span>
<span class="sd">                Must have the same columns as df_full.</span>
<span class="sd">            variables: List of variable names to include. If None, uses all columns.</span>
<span class="sd">            full_label: Label suffix for full dataset traces. Default &#39;Full&#39;.</span>
<span class="sd">            selection_label: Label suffix for selection traces. Default &#39;Selection&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure object ready for display or further customization.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If DataFrames don&#39;t have DatetimeIndex or columns don&#39;t match.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_full must have a DatetimeIndex&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_selection must have a DatetimeIndex&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_full and df_selection must have the same columns&quot;</span><span class="p">)</span>

        <span class="c1"># Determine which variables to plot</span>
        <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">variables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Validate requested variables</span>
            <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables not found in DataFrames: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Extract hour from index</span>
        <span class="n">df_full_with_hour</span> <span class="o">=</span> <span class="n">df_full</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df_full_with_hour</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>

        <span class="n">df_selection_with_hour</span> <span class="o">=</span> <span class="n">df_selection</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">df_selection_with_hour</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>

        <span class="c1"># Calculate mean profiles</span>
        <span class="n">full_profile</span> <span class="o">=</span> <span class="n">df_full_with_hour</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">selection_profile</span> <span class="o">=</span> <span class="n">df_selection_with_hour</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="c1"># Add traces for each variable</span>
        <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
            <span class="c1"># Full dataset trace</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">full_profile</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">full_profile</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">full_label</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="p">))</span>

            <span class="c1"># Selection trace</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">selection_profile</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">selection_profile</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">selection_label</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">),</span>
            <span class="p">))</span>

        <span class="c1"># Update layout</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Hour of Day&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Mean Value&#39;</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
            <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">dtick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">23.5</span><span class="p">],</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DiurnalProfileOverlay.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the diurnal profile overlay diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/diurnal_profile_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the diurnal profile overlay diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.score_components.DiurnalProfileOverlay.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.score_components.DiurnalProfileOverlay.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">df_full</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">df_selection</span><span class="p">:</span> <span class="n"><span title="pandas.DataFrame">DataFrame</span></span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> <span class="n">selection_label</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a diurnal profile overlay plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df_full</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with DatetimeIndex and variable columns for full dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>df_selection</code>
            </td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame with DatetimeIndex and variable columns for selection.
Must have the same columns as df_full.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of variable names to include. If None, uses all columns.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label suffix for full dataset traces. Default 'Full'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Full&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selection_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label suffix for selection traces. Default 'Selection'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Selection&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure object ready for display or further customization.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If DataFrames don't have DatetimeIndex or columns don't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/score_components/diurnal_profile_overlay.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">df_full</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">df_selection</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">variables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">full_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span>
    <span class="n">selection_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Selection&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a diurnal profile overlay plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        df_full: DataFrame with DatetimeIndex and variable columns for full dataset.</span>
<span class="sd">        df_selection: DataFrame with DatetimeIndex and variable columns for selection.</span>
<span class="sd">            Must have the same columns as df_full.</span>
<span class="sd">        variables: List of variable names to include. If None, uses all columns.</span>
<span class="sd">        full_label: Label suffix for full dataset traces. Default &#39;Full&#39;.</span>
<span class="sd">        selection_label: Label suffix for selection traces. Default &#39;Selection&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure object ready for display or further customization.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If DataFrames don&#39;t have DatetimeIndex or columns don&#39;t match.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_full must have a DatetimeIndex&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_selection must have a DatetimeIndex&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_selection</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;df_full and df_selection must have the same columns&quot;</span><span class="p">)</span>

    <span class="c1"># Determine which variables to plot</span>
    <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">variables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Validate requested variables</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_full</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables not found in DataFrames: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extract hour from index</span>
    <span class="n">df_full_with_hour</span> <span class="o">=</span> <span class="n">df_full</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_full_with_hour</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_full</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>

    <span class="n">df_selection_with_hour</span> <span class="o">=</span> <span class="n">df_selection</span><span class="p">[</span><span class="n">variables</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df_selection_with_hour</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_selection</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>

    <span class="c1"># Calculate mean profiles</span>
    <span class="n">full_profile</span> <span class="o">=</span> <span class="n">df_full_with_hour</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">selection_profile</span> <span class="o">=</span> <span class="n">df_selection_with_hour</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;hour&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">numeric_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="c1"># Add traces for each variable</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="c1"># Full dataset trace</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">full_profile</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">full_profile</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">full_label</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
        <span class="p">))</span>

        <span class="c1"># Selection trace</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">selection_profile</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">selection_profile</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines+markers&#39;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">variable</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">selection_label</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">),</span>
        <span class="p">))</span>

    <span class="c1"># Update layout</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Hour of Day&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Mean Value&#39;</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x unified&#39;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">tickmode</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="n">tick0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">dtick</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">23.5</span><span class="p">],</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="results">Results<a class="headerlink" href="#results" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.results.ResponsibilityBars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ResponsibilityBars</span>


<a href="#energy_repset.diagnostics.results.ResponsibilityBars" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Bar chart showing responsibility weights for selected representatives.</p>
<p>Visualizes the weight distribution across selected periods as computed by
a RepresentationModel. Each bar shows how much each representative
contributes to the full dataset representation.</p>
<p>Optionally displays a reference line showing uniform weights (1/k) for
comparison with non-uniform weighting schemes like cluster-size based
weights.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from energy_repset.diagnostics.results import ResponsibilityBars
&gt;&gt;&gt;
&gt;&gt;&gt; # After running workflow with result containing weights
&gt;&gt;&gt; weights = result.weights  # e.g., {Period(&#39;2024-01&#39;): 0.35, ...}
&gt;&gt;&gt; bars = ResponsibilityBars()
&gt;&gt;&gt; fig = bars.plot(weights, show_uniform_reference=True)
&gt;&gt;&gt; fig.update_layout(title=&#39;Responsibility Weights&#39;)
&gt;&gt;&gt; fig.show()
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/results/responsibility_bars.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ResponsibilityBars</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Bar chart showing responsibility weights for selected representatives.</span>

<span class="sd">    Visualizes the weight distribution across selected periods as computed by</span>
<span class="sd">    a RepresentationModel. Each bar shows how much each representative</span>
<span class="sd">    contributes to the full dataset representation.</span>

<span class="sd">    Optionally displays a reference line showing uniform weights (1/k) for</span>
<span class="sd">    comparison with non-uniform weighting schemes like cluster-size based</span>
<span class="sd">    weights.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from energy_repset.diagnostics.results import ResponsibilityBars</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # After running workflow with result containing weights</span>
<span class="sd">        &gt;&gt;&gt; weights = result.weights  # e.g., {Period(&#39;2024-01&#39;): 0.35, ...}</span>
<span class="sd">        &gt;&gt;&gt; bars = ResponsibilityBars()</span>
<span class="sd">        &gt;&gt;&gt; fig = bars.plot(weights, show_uniform_reference=True)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Responsibility Weights&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize ResponsibilityBars diagnostic.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">show_uniform_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create bar chart of responsibility weights.</span>

<span class="sd">        Args:</span>
<span class="sd">            weights: Dictionary mapping slice identifiers to their weights.</span>
<span class="sd">                Weights should sum to 1.0 for meaningful comparison with</span>
<span class="sd">                the uniform reference line.</span>
<span class="sd">            show_uniform_reference: If True, adds horizontal dashed line</span>
<span class="sd">                showing uniform weight (1/k) for comparison.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure with bar chart. X-axis shows slice labels, Y-axis</span>
<span class="sd">            shows weight values. Text labels show weights to 3 decimal places.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If weights dictionary is empty.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">weights</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Weights dictionary cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># Prepare data for plotting</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;slice&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
            <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="p">})</span>

        <span class="c1"># Create bar chart</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="s1">&#39;slice&#39;</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span>
        <span class="p">)</span>

        <span class="c1"># Format text labels to 3 decimal places, position outside bars</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
            <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{y:.3f}</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span>
        <span class="p">)</span>

        <span class="c1"># Set y-axis range and label</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">],</span>  <span class="c1"># Add headroom for text labels</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Responsibility Weight&#39;</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Selected Period&#39;</span><span class="p">)</span>

        <span class="c1"># Add uniform reference line if requested</span>
        <span class="k">if</span> <span class="n">show_uniform_reference</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">uniform_weight</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
                <span class="n">y</span><span class="o">=</span><span class="n">uniform_weight</span><span class="p">,</span>
                <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span>
                <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Uniform (</span><span class="si">{</span><span class="n">uniform_weight</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
                <span class="n">annotation_position</span><span class="o">=</span><span class="s1">&#39;top left&#39;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ResponsibilityBars.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.results.ResponsibilityBars.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize ResponsibilityBars diagnostic.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/responsibility_bars.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize ResponsibilityBars diagnostic.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ResponsibilityBars.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.results.ResponsibilityBars.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">weights</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="typing.Hashable">Hashable</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">],</span> <span class="n">show_uniform_reference</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create bar chart of responsibility weights.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>weights</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="typing.Hashable">Hashable</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping slice identifiers to their weights.
Weights should sum to 1.0 for meaningful comparison with
the uniform reference line.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>show_uniform_reference</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, adds horizontal dashed line
showing uniform weight (1/k) for comparison.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with bar chart. X-axis shows slice labels, Y-axis</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shows weight values. Text labels show weights to 3 decimal places.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If weights dictionary is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/responsibility_bars.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">show_uniform_reference</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create bar chart of responsibility weights.</span>

<span class="sd">    Args:</span>
<span class="sd">        weights: Dictionary mapping slice identifiers to their weights.</span>
<span class="sd">            Weights should sum to 1.0 for meaningful comparison with</span>
<span class="sd">            the uniform reference line.</span>
<span class="sd">        show_uniform_reference: If True, adds horizontal dashed line</span>
<span class="sd">            showing uniform weight (1/k) for comparison.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure with bar chart. X-axis shows slice labels, Y-axis</span>
<span class="sd">        shows weight values. Text labels show weights to 3 decimal places.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If weights dictionary is empty.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">weights</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Weights dictionary cannot be empty&quot;</span><span class="p">)</span>

    <span class="c1"># Prepare data for plotting</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;slice&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
        <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="p">})</span>

    <span class="c1"># Create bar chart</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;slice&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Format text labels to 3 decimal places, position outside bars</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
        <span class="n">texttemplate</span><span class="o">=</span><span class="s1">&#39;%</span><span class="si">{y:.3f}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span>
    <span class="p">)</span>

    <span class="c1"># Set y-axis range and label</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
        <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">],</span>  <span class="c1"># Add headroom for text labels</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Responsibility Weight&#39;</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Selected Period&#39;</span><span class="p">)</span>

    <span class="c1"># Add uniform reference line if requested</span>
    <span class="k">if</span> <span class="n">show_uniform_reference</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">uniform_weight</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
            <span class="n">y</span><span class="o">=</span><span class="n">uniform_weight</span><span class="p">,</span>
            <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">,</span>
            <span class="n">annotation_text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Uniform (</span><span class="si">{</span><span class="n">uniform_weight</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
            <span class="n">annotation_position</span><span class="o">=</span><span class="s1">&#39;top left&#39;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.results.ParetoScatter2D" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ParetoScatter2D</span>


<a href="#energy_repset.diagnostics.results.ParetoScatter2D" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>2D scatter plot of all evaluated combinations with Pareto front highlighted.</p>
<p>Visualizes the objective space for two objectives, showing:
- All evaluated combinations as scatter points
- Pareto-optimal solutions highlighted
- Selected combination (if provided) marked distinctly
- Feasible vs infeasible solutions (if constraints exist)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objective_x</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of objective for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_y</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of objective for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">energy_repset.diagnostics.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParetoScatter2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatter</span> <span class="o">=</span> <span class="n">ParetoScatter2D</span><span class="p">(</span><span class="n">objective_x</span><span class="o">=</span><span class="s1">&#39;wasserstein&#39;</span><span class="p">,</span> <span class="n">objective_y</span><span class="o">=</span><span class="s1">&#39;correlation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">scatter</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">search_algorithm</span><span class="o">=</span><span class="n">workflow</span><span class="o">.</span><span class="n">search_algorithm</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">selected_combination</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">selection</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pareto Front: Wasserstein vs Correlation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParetoScatter2D</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;2D scatter plot of all evaluated combinations with Pareto front highlighted.</span>

<span class="sd">    Visualizes the objective space for two objectives, showing:</span>
<span class="sd">    - All evaluated combinations as scatter points</span>
<span class="sd">    - Pareto-optimal solutions highlighted</span>
<span class="sd">    - Selected combination (if provided) marked distinctly</span>
<span class="sd">    - Feasible vs infeasible solutions (if constraints exist)</span>

<span class="sd">    Args:</span>
<span class="sd">        objective_x: Name of objective for x-axis.</span>
<span class="sd">        objective_y: Name of objective for y-axis.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from energy_repset.diagnostics.results import ParetoScatter2D</span>
<span class="sd">        &gt;&gt;&gt; scatter = ParetoScatter2D(objective_x=&#39;wasserstein&#39;, objective_y=&#39;correlation&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter.plot(</span>
<span class="sd">        ...     search_algorithm=workflow.search_algorithm,</span>
<span class="sd">        ...     selected_combination=result.selection</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Pareto Front: Wasserstein vs Correlation&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">objective_y</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize Pareto scatter diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            objective_x: Name of objective for x-axis.</span>
<span class="sd">            objective_y: Name of objective for y-axis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span> <span class="o">=</span> <span class="n">objective_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span> <span class="o">=</span> <span class="n">objective_y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
        <span class="n">selected_combination</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create 2D scatter plot of Pareto front.</span>

<span class="sd">        Args:</span>
<span class="sd">            search_algorithm: Search algorithm after find_selection() has been called.</span>
<span class="sd">            selected_combination: Optional combination to highlight (e.g., result.selection).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure with scatter plot.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If find_selection() hasn&#39;t been called or objectives not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

        <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
            <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">x_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="p">]</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
            <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>

            <span class="n">infeasible</span> <span class="o">=</span> <span class="o">~</span><span class="n">feasible</span>
            <span class="k">if</span> <span class="n">infeasible</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">infeasible</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">infeasible</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Infeasible&#39;</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                    <span class="p">),</span>
                <span class="p">))</span>

            <span class="n">dominated</span> <span class="o">=</span> <span class="n">feasible</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">pareto</span>
            <span class="k">if</span> <span class="n">dominated</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">dominated</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">dominated</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dominated&#39;</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                    <span class="p">),</span>
                <span class="p">))</span>

            <span class="n">pareto_points</span> <span class="o">=</span> <span class="n">pareto</span> <span class="o">&amp;</span> <span class="n">feasible</span>
            <span class="k">if</span> <span class="n">pareto_points</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">pareto_points</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">pareto_points</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Pareto Front&#39;</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                    <span class="p">),</span>
                <span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;All Combinations&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                <span class="p">),</span>
            <span class="p">))</span>

        <span class="k">if</span> <span class="n">selected_combination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">selected_combination</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">selected_idx</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">sel_x</span> <span class="o">=</span> <span class="n">x_vals</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">sel_y</span> <span class="o">=</span> <span class="n">y_vals</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">sel_x</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">sel_y</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                        <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                        <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">,</span>
                        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Selected&#39;</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                        <span class="s1">&#39;&lt;b&gt;SELECTED&lt;/b&gt;&lt;br&gt;&#39;</span>
                        <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                    <span class="p">),</span>
                <span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoScatter2D.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.results.ParetoScatter2D.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">objective_x</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">objective_y</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize Pareto scatter diagnostic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objective_x</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of objective for x-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>objective_y</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of objective for y-axis.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objective_x</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">objective_y</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize Pareto scatter diagnostic.</span>

<span class="sd">    Args:</span>
<span class="sd">        objective_x: Name of objective for x-axis.</span>
<span class="sd">        objective_y: Name of objective for y-axis.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span> <span class="o">=</span> <span class="n">objective_x</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span> <span class="o">=</span> <span class="n">objective_y</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoScatter2D.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.results.ParetoScatter2D.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">search_algorithm</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></span><span class="p">,</span> <span class="n">selected_combination</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create 2D scatter plot of Pareto front.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>search_algorithm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search algorithm after find_selection() has been called.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selected_combination</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional combination to highlight (e.g., result.selection).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with scatter plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If find_selection() hasn't been called or objectives not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
    <span class="n">selected_combination</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create 2D scatter plot of Pareto front.</span>

<span class="sd">    Args:</span>
<span class="sd">        search_algorithm: Search algorithm after find_selection() has been called.</span>
<span class="sd">        selected_combination: Optional combination to highlight (e.g., result.selection).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure with scatter plot.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If find_selection() hasn&#39;t been called or objectives not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

    <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
    <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

    <span class="n">x_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="p">]</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
        <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>

        <span class="n">infeasible</span> <span class="o">=</span> <span class="o">~</span><span class="n">feasible</span>
        <span class="k">if</span> <span class="n">infeasible</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">infeasible</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">infeasible</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Infeasible&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                <span class="p">),</span>
            <span class="p">))</span>

        <span class="n">dominated</span> <span class="o">=</span> <span class="n">feasible</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">pareto</span>
        <span class="k">if</span> <span class="n">dominated</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">dominated</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">dominated</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dominated&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                <span class="p">),</span>
            <span class="p">))</span>

        <span class="n">pareto_points</span> <span class="o">=</span> <span class="n">pareto</span> <span class="o">&amp;</span> <span class="n">feasible</span>
        <span class="k">if</span> <span class="n">pareto_points</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">[</span><span class="n">pareto_points</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">[</span><span class="n">pareto_points</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;diamond&#39;</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Pareto Front&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                <span class="p">),</span>
            <span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x_vals</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">y_vals</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;All Combinations&#39;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
            <span class="p">),</span>
        <span class="p">))</span>

    <span class="k">if</span> <span class="n">selected_combination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">selected_combination</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selected_idx</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">sel_x</span> <span class="o">=</span> <span class="n">x_vals</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sel_y</span> <span class="o">=</span> <span class="n">y_vals</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">sel_x</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">sel_y</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                    <span class="n">symbol</span><span class="o">=</span><span class="s1">&#39;star&#39;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
                <span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Selected&#39;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">x:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="si">}</span><span class="s1">: %</span><span class="se">{{</span><span class="s1">y:.4f</span><span class="se">}}</span><span class="s1">&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;b&gt;SELECTED&lt;/b&gt;&lt;br&gt;&#39;</span>
                    <span class="s1">&#39;&lt;extra&gt;&lt;/extra&gt;&#39;</span>
                <span class="p">),</span>
            <span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_x</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">objective_y</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;closest&#39;</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.results.ParetoScatterMatrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ParetoScatterMatrix</span>


<a href="#energy_repset.diagnostics.results.ParetoScatterMatrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Scatter matrix of all objectives showing Pareto front.</p>
<p>Creates a scatter plot matrix (SPLOM) showing pairwise relationships between
all objectives. Each subplot shows two objectives with Pareto front highlighted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objectives</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of objective names to include (None = all objectives).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">energy_repset.diagnostics.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParetoScatterMatrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scatter_matrix</span> <span class="o">=</span> <span class="n">ParetoScatterMatrix</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">objectives</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wasserstein&#39;</span><span class="p">,</span> <span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="s1">&#39;diurnal&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">scatter_matrix</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">search_algorithm</span><span class="o">=</span><span class="n">workflow</span><span class="o">.</span><span class="n">search_algorithm</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">selected_combination</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">selection</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pareto Front: All Objectives&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParetoScatterMatrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scatter matrix of all objectives showing Pareto front.</span>

<span class="sd">    Creates a scatter plot matrix (SPLOM) showing pairwise relationships between</span>
<span class="sd">    all objectives. Each subplot shows two objectives with Pareto front highlighted.</span>

<span class="sd">    Args:</span>
<span class="sd">        objectives: List of objective names to include (None = all objectives).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from energy_repset.diagnostics.results import ParetoScatterMatrix</span>
<span class="sd">        &gt;&gt;&gt; scatter_matrix = ParetoScatterMatrix(</span>
<span class="sd">        ...     objectives=[&#39;wasserstein&#39;, &#39;correlation&#39;, &#39;diurnal&#39;]</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; fig = scatter_matrix.plot(</span>
<span class="sd">        ...     search_algorithm=workflow.search_algorithm,</span>
<span class="sd">        ...     selected_combination=result.selection</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Pareto Front: All Objectives&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectives</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize Pareto scatter matrix diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            objectives: List of objective names to include (None = all).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
        <span class="n">selected_combination</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create scatter matrix of Pareto front.</span>

<span class="sd">        Args:</span>
<span class="sd">            search_algorithm: Search algorithm after find_selection() has been called.</span>
<span class="sd">            selected_combination: Optional combination to highlight.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure with scatter matrix.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If find_selection() hasn&#39;t been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 objectives for scatter matrix&quot;</span><span class="p">)</span>

        <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
            <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

        <span class="n">color_col</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_plot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
            <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>
            <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Dominated&#39;</span>
            <span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">feasible</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Infeasible&#39;</span>
            <span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pareto</span> <span class="o">&amp;</span> <span class="n">feasible</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Pareto Front&#39;</span>
            <span class="n">color_col</span> <span class="o">=</span> <span class="s1">&#39;category&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_plot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
            <span class="n">dimensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
            <span class="p">))</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Splom</span><span class="p">(</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="n">color_col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
                    <span class="s1">&#39;Infeasible&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s1">&#39;Dominated&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;Pareto Front&#39;</span><span class="p">:</span> <span class="mi">2</span>
                <span class="p">})</span> <span class="k">if</span> <span class="n">color_col</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">colorscale</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;steelblue&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="n">color_col</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">showscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
            <span class="p">),</span>
            <span class="n">text</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df_plot</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">diagonal_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">showupperhalf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">))</span>

        <span class="k">if</span> <span class="n">selected_combination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">selected_combination</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">selected_idx</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">selected_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">,</span> <span class="n">obj</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">]</span>
                <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                        <span class="n">xaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;x&#39;</span>
                        <span class="n">yaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;y</span><span class="si">{</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;y&#39;</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scatter Matrix: All Objectives&#39;</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">150</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">150</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoScatterMatrix.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">objectives</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize Pareto scatter matrix diagnostic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objectives</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of objective names to include (None = all).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectives</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize Pareto scatter matrix diagnostic.</span>

<span class="sd">    Args:</span>
<span class="sd">        objectives: List of objective names to include (None = all).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoScatterMatrix.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.results.ParetoScatterMatrix.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">search_algorithm</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></span><span class="p">,</span> <span class="n">selected_combination</span><span class="p">:</span> <span class="n"><span title="energy_repset.types.SliceCombination">SliceCombination</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create scatter matrix of Pareto front.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>search_algorithm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search algorithm after find_selection() has been called.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>selected_combination</code>
            </td>
            <td>
                  <code><span title="energy_repset.types.SliceCombination">SliceCombination</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional combination to highlight.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with scatter matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If find_selection() hasn't been called.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_scatter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
    <span class="n">selected_combination</span><span class="p">:</span> <span class="n">SliceCombination</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create scatter matrix of Pareto front.</span>

<span class="sd">    Args:</span>
<span class="sd">        search_algorithm: Search algorithm after find_selection() has been called.</span>
<span class="sd">        selected_combination: Optional combination to highlight.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure with scatter matrix.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If find_selection() hasn&#39;t been called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">obj_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 objectives for scatter matrix&quot;</span><span class="p">)</span>

    <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
    <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

    <span class="n">color_col</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df_plot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
        <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>
        <span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Dominated&#39;</span>
        <span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">feasible</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Infeasible&#39;</span>
        <span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pareto</span> <span class="o">&amp;</span> <span class="n">feasible</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Pareto Front&#39;</span>
        <span class="n">color_col</span> <span class="o">=</span> <span class="s1">&#39;category&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_plot</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
        <span class="n">dimensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
        <span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Splom</span><span class="p">(</span>
        <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="n">color_col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span>
                <span class="s1">&#39;Infeasible&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;Dominated&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;Pareto Front&#39;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">})</span> <span class="k">if</span> <span class="n">color_col</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">colorscale</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;steelblue&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]]</span> <span class="k">if</span> <span class="n">color_col</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">showscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">text</span><span class="o">=</span><span class="n">df_plot</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">df_plot</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">diagonal_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">showupperhalf</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">))</span>

    <span class="k">if</span> <span class="n">selected_combination</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selected_idx</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">==</span> <span class="n">selected_combination</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selected_idx</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">selected_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">df_plot</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">,</span> <span class="n">obj</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">]</span>
            <span class="n">n_dims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_dims</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                    <span class="n">xaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;x</span><span class="si">{</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;x&#39;</span>
                    <span class="n">yaxis</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;y</span><span class="si">{</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">n_dims</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;y&#39;</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Scatter Matrix: All Objectives&#39;</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">150</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">150</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">),</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.results.ParetoParallelCoordinates" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ParetoParallelCoordinates</span>


<a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Parallel coordinates plot of Pareto front.</p>
<p>Visualizes multi-objective trade-offs using parallel coordinates where each
vertical axis represents one objective. Lines connecting axes show individual
solutions, with Pareto-optimal solutions highlighted.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objectives</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of objective names to include (None = all objectives).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">energy_repset.diagnostics.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParetoParallelCoordinates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parallel</span> <span class="o">=</span> <span class="n">ParetoParallelCoordinates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">parallel</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">=</span><span class="n">workflow</span><span class="o">.</span><span class="n">search_algorithm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pareto Front: Parallel Coordinates&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/results/pareto_parallel_coords.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParetoParallelCoordinates</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parallel coordinates plot of Pareto front.</span>

<span class="sd">    Visualizes multi-objective trade-offs using parallel coordinates where each</span>
<span class="sd">    vertical axis represents one objective. Lines connecting axes show individual</span>
<span class="sd">    solutions, with Pareto-optimal solutions highlighted.</span>

<span class="sd">    Args:</span>
<span class="sd">        objectives: List of objective names to include (None = all objectives).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from energy_repset.diagnostics.results import ParetoParallelCoordinates</span>
<span class="sd">        &gt;&gt;&gt; parallel = ParetoParallelCoordinates()</span>
<span class="sd">        &gt;&gt;&gt; fig = parallel.plot(search_algorithm=workflow.search_algorithm)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Pareto Front: Parallel Coordinates&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectives</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize parallel coordinates diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            objectives: List of objective names to include (None = all).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create parallel coordinates plot of Pareto front.</span>

<span class="sd">        Args:</span>
<span class="sd">            search_algorithm: Search algorithm after find_selection() has been called.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure with parallel coordinates plot.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If find_selection() hasn&#39;t been called.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 objectives for parallel coordinates&quot;</span><span class="p">)</span>

        <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
            <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

        <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
            <span class="n">dimensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
            <span class="p">))</span>

        <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
            <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>

            <span class="n">color_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">feasible</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pareto</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">color</span><span class="o">=</span><span class="n">color_values</span><span class="p">,</span>
                    <span class="n">colorscale</span><span class="o">=</span><span class="p">[</span>
                        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;steelblue&#39;</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]</span>
                    <span class="p">],</span>
                    <span class="n">showscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">cmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">cmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span>
                        <span class="n">tickvals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                        <span class="n">ticktext</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Infeasible&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominated&#39;</span><span class="p">,</span> <span class="s1">&#39;Pareto&#39;</span><span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
                <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span>
                    <span class="n">showscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Parallel Coordinates: All Objectives&#39;</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoParallelCoordinates.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">__init__</span>


<a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.__init__" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span><span class="n">objectives</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize parallel coordinates diagnostic.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>objectives</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of objective names to include (None = all).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_parallel_coords.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objectives</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize parallel coordinates diagnostic.</span>

<span class="sd">    Args:</span>
<span class="sd">        objectives: List of objective names to include (None = all).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="o">=</span> <span class="n">objectives</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ParetoParallelCoordinates.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.results.ParetoParallelCoordinates.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">search_algorithm</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create parallel coordinates plot of Pareto front.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>search_algorithm</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ObjectiveDrivenCombinatorialSearchAlgorithm (energy_repset.search_algorithms.objective_driven.ObjectiveDrivenCombinatorialSearchAlgorithm)" href="../search_algorithms/#energy_repset.search_algorithms.ObjectiveDrivenCombinatorialSearchAlgorithm">ObjectiveDrivenCombinatorialSearchAlgorithm</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search algorithm after find_selection() has been called.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with parallel coordinates plot.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If find_selection() hasn't been called.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/pareto_parallel_coords.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">search_algorithm</span><span class="p">:</span> <span class="n">ObjectiveDrivenCombinatorialSearchAlgorithm</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create parallel coordinates plot of Pareto front.</span>

<span class="sd">    Args:</span>
<span class="sd">        search_algorithm: Search algorithm after find_selection() has been called.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure with parallel coordinates plot.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If find_selection() hasn&#39;t been called.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">get_all_scores</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">obj_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;slices&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj_cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objectives</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Objective &#39;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">&#39; not found in scores&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least 2 objectives for parallel coordinates&quot;</span><span class="p">)</span>

    <span class="n">has_pareto</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="p">,</span> <span class="s1">&#39;pareto_mask&#39;</span><span class="p">)</span>
    <span class="n">pareto_mask</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">feasible_mask</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">pareto_mask</span>
        <span class="n">feasible_mask</span> <span class="o">=</span> <span class="n">search_algorithm</span><span class="o">.</span><span class="n">selection_policy</span><span class="o">.</span><span class="n">feasible_mask</span>

    <span class="n">dimensions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_cols</span><span class="p">:</span>
        <span class="n">dimensions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">label</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span>
        <span class="p">))</span>

    <span class="k">if</span> <span class="n">has_pareto</span> <span class="ow">and</span> <span class="n">pareto_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pareto</span> <span class="o">=</span> <span class="n">pareto_mask</span><span class="o">.</span><span class="n">values</span>
        <span class="n">feasible</span> <span class="o">=</span> <span class="n">feasible_mask</span><span class="o">.</span><span class="n">values</span>

        <span class="n">color_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">feasible</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">pareto</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color_values</span><span class="p">,</span>
                <span class="n">colorscale</span><span class="o">=</span><span class="p">[</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;lightgray&#39;</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;steelblue&#39;</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;darkorange&#39;</span><span class="p">]</span>
                <span class="p">],</span>
                <span class="n">showscale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">cmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">cmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span>
                    <span class="n">tickvals</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="n">ticktext</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Infeasible&#39;</span><span class="p">,</span> <span class="s1">&#39;Dominated&#39;</span><span class="p">,</span> <span class="s1">&#39;Pareto&#39;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Parcoords</span><span class="p">(</span>
            <span class="n">dimensions</span><span class="o">=</span><span class="n">dimensions</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span>
                <span class="n">showscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">))</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Parallel Coordinates: All Objectives&#39;</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="energy_repset.diagnostics.results.ScoreContributionBars" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">ScoreContributionBars</span>


<a href="#energy_repset.diagnostics.results.ScoreContributionBars" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents first">



        <p>Bar chart showing final scores from each objective component.</p>
<p>Visualizes the contribution of each score component to understand which
objectives were most influential in the final selection. Can display
absolute scores or normalized as fractions of total.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">energy_repset.diagnostics.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScoreContributionBars</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contrib</span> <span class="o">=</span> <span class="n">ScoreContributionBars</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">contrib</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">scores</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Score Component Contributions&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>energy_repset/diagnostics/results/score_contribution_bars.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ScoreContributionBars</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Bar chart showing final scores from each objective component.</span>

<span class="sd">    Visualizes the contribution of each score component to understand which</span>
<span class="sd">    objectives were most influential in the final selection. Can display</span>
<span class="sd">    absolute scores or normalized as fractions of total.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from energy_repset.diagnostics.results import ScoreContributionBars</span>
<span class="sd">        &gt;&gt;&gt; contrib = ScoreContributionBars()</span>
<span class="sd">        &gt;&gt;&gt; fig = contrib.plot(result.scores, normalize=True)</span>
<span class="sd">        &gt;&gt;&gt; fig.update_layout(title=&#39;Score Component Contributions&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create bar chart of score component contributions.</span>

<span class="sd">        Args:</span>
<span class="sd">            scores: Dictionary of scores from each component (from result.scores).</span>
<span class="sd">            normalize: If True, show as fractions of total score.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Plotly figure with bar chart.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scores</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Scores dictionary is empty&quot;</span><span class="p">)</span>

        <span class="n">component_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">score_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">score_values</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot normalize: total score is zero&quot;</span><span class="p">)</span>
            <span class="n">score_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="n">total</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">score_values</span><span class="p">]</span>
            <span class="n">y_title</span> <span class="o">=</span> <span class="s1">&#39;Normalized Score (fraction)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y_title</span> <span class="o">=</span> <span class="s1">&#39;Score Value&#39;</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">component_names</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">score_values</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">score_values</span><span class="p">],</span>
                <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">])</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Score Component&#39;</span><span class="p">,</span>
            <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_title</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="energy_repset.diagnostics.results.ScoreContributionBars.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">plot</span>


<a href="#energy_repset.diagnostics.results.ScoreContributionBars.plot" class="headerlink" title="Permanent link">&para;</a></h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">plot</span><span class="p">(</span><span class="n">scores</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="float">float</span></span><span class="p">],</span> <span class="n">normalize</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="plotly.graph_objects.Figure">Figure</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create bar chart of score component contributions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of scores from each component (from result.scores).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, show as fractions of total score.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="plotly.graph_objects.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plotly figure with bar chart.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>energy_repset/diagnostics/results/score_contribution_bars.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">scores</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create bar chart of score component contributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        scores: Dictionary of scores from each component (from result.scores).</span>
<span class="sd">        normalize: If True, show as fractions of total score.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Plotly figure with bar chart.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">scores</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Scores dictionary is empty&quot;</span><span class="p">)</span>

    <span class="n">component_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">score_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">score_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot normalize: total score is zero&quot;</span><span class="p">)</span>
        <span class="n">score_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="n">total</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">score_values</span><span class="p">]</span>
        <span class="n">y_title</span> <span class="o">=</span> <span class="s1">&#39;Normalized Score (fraction)&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_title</span> <span class="o">=</span> <span class="s1">&#39;Score Value&#39;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">component_names</span><span class="p">,</span>
            <span class="n">y</span><span class="o">=</span><span class="n">score_values</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">score_values</span><span class="p">],</span>
            <span class="n">textposition</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">])</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Score Component&#39;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_title</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">hovermode</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "content.tabs.link", "navigation.sections"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../javascripts/github_source_links.js"></script>
      
    
  </body>
</html>